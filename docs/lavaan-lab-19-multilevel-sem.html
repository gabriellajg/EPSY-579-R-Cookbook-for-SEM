<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 22 Lavaan Lab 19: Multilevel SEM | R Cookbook for Structural Equation Modeling</title>
  <meta name="description" content="Chapter 22 Lavaan Lab 19: Multilevel SEM | R Cookbook for Structural Equation Modeling" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 22 Lavaan Lab 19: Multilevel SEM | R Cookbook for Structural Equation Modeling" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 22 Lavaan Lab 19: Multilevel SEM | R Cookbook for Structural Equation Modeling" />
  
  
  

<meta name="author" content="Ge Jiang" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lavaan-lab-18-cfa-of-mtmm-matrix.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EPSY:579 R Cookbook for SEM</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Course</a></li>
<li class="chapter" data-level="2" data-path="into-to-r.html"><a href="into-to-r.html"><i class="fa fa-check"></i><b>2</b> Into to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="into-to-r.html"><a href="into-to-r.html#r-as-a-calculator"><i class="fa fa-check"></i><b>2.1</b> R as a calculator</a></li>
<li class="chapter" data-level="2.2" data-path="into-to-r.html"><a href="into-to-r.html#assigning-objects-and-basic-data-entry"><i class="fa fa-check"></i><b>2.2</b> Assigning Objects and Basic Data Entry</a></li>
<li class="chapter" data-level="2.3" data-path="into-to-r.html"><a href="into-to-r.html#removing-an-object-from-the-workspace"><i class="fa fa-check"></i><b>2.3</b> Removing an object from the workspace</a></li>
<li class="chapter" data-level="2.4" data-path="into-to-r.html"><a href="into-to-r.html#formal-rules-for-indexing-objects-in-r"><i class="fa fa-check"></i><b>2.4</b> Formal Rules for Indexing Objects in R</a></li>
<li class="chapter" data-level="2.5" data-path="into-to-r.html"><a href="into-to-r.html#examples"><i class="fa fa-check"></i><b>2.5</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html"><i class="fa fa-check"></i><b>3</b> Lavaan Lab 1: Path Analysis Model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#reading-in-and-working-with-realistic-datasets-in-r"><i class="fa fa-check"></i><b>3.1</b> Reading-In and Working With Realistic Datasets In R</a></li>
<li class="chapter" data-level="3.2" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#sample-covariance-matrices-using-the-cov-function"><i class="fa fa-check"></i><b>3.2</b> Sample Covariance Matrices using the cov() function</a></li>
<li class="chapter" data-level="3.3" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#installing-packages"><i class="fa fa-check"></i><b>3.3</b> Installing Packages</a></li>
<li class="chapter" data-level="3.4" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#loading-packages-libraries-that-you-have-installed"><i class="fa fa-check"></i><b>3.4</b> Loading Packages (Libraries) That You Have Installed</a></li>
<li class="chapter" data-level="3.5" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#using-lavaan-for-path-models"><i class="fa fa-check"></i><b>3.5</b> Using Lavaan For Path Models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#part-i-follow-the-set-of-equations-we-wrote-in-class"><i class="fa fa-check"></i><b>3.5.1</b> PART I: Follow the set of equations we wrote in class:</a></li>
<li class="chapter" data-level="3.5.2" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#part-ii-lets-run-our-model"><i class="fa fa-check"></i><b>3.5.2</b> PART II Let’s run our model!</a></li>
<li class="chapter" data-level="3.5.3" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#sigma-matrices"><i class="fa fa-check"></i><b>3.5.3</b> Sigma Matrices</a></li>
<li class="chapter" data-level="3.5.4" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#part-iii-summarizing-our-analysis"><i class="fa fa-check"></i><b>3.5.4</b> PART III: Summarizing Our Analysis:</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#plotting-sem-model"><i class="fa fa-check"></i><b>3.6</b> Plotting SEM model</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#customize-it-your-way"><i class="fa fa-check"></i><b>3.6.1</b> customize it your way</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="lavaan-lab-1-path-analysis-model.html"><a href="lavaan-lab-1-path-analysis-model.html#exercise-how-would-you-fit-the-model-in-saunders-et-al.-2016"><i class="fa fa-check"></i><b>3.7</b> Exercise: How would you fit the model in Saunders et al. (2016)?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html"><i class="fa fa-check"></i><b>4</b> Lavaan Lab 2: Mediation and Indirect Effects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#reading-in-and-working-with-realistic-datasets-in-r-1"><i class="fa fa-check"></i><b>4.1</b> Reading-In and Working With Realistic Datasets In R</a></li>
<li class="chapter" data-level="4.2" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#using-lavaan-for-mediation-models---preacher-hayess"><i class="fa fa-check"></i><b>4.2</b> Using Lavaan For Mediation Models - Preacher &amp; Hayes’s</a></li>
<li class="chapter" data-level="4.3" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#part-i-follow-the-two-equations-of-m-dietse-y-bulimia"><i class="fa fa-check"></i><b>4.3</b> PART I: # Follow the two equations of M (DietSE) &amp; Y (Bulimia)</a></li>
<li class="chapter" data-level="4.4" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#part-ii-lets-run-our-model-1"><i class="fa fa-check"></i><b>4.4</b> PART II Let’s run our model!</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#label-the-mediation-effect"><i class="fa fa-check"></i><b>4.4.1</b> Label the mediation effect</a></li>
<li class="chapter" data-level="4.4.2" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#define-a-new-term-for-the-mediation-effect-ab"><i class="fa fa-check"></i><b>4.4.2</b> Define a new term for the mediation effect a*b</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#part-iii-summarizing-our-analysis-1"><i class="fa fa-check"></i><b>4.5</b> PART III: Summarizing Our Analysis:</a></li>
<li class="chapter" data-level="4.6" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#part-iv-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>4.6</b> PART IV: Bootstrap confidence intervals</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#the-default-one-is-boot.ci.type-perc"><i class="fa fa-check"></i><b>4.6.1</b> The default one is boot.ci.type = “perc”</a></li>
<li class="chapter" data-level="4.6.2" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#bc-bias-corrected-confidence-interval"><i class="fa fa-check"></i><b>4.6.2</b> BC (bias-corrected) confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#in-class-exercise-use-lavaan-to-estimate-and-interpret-the-following-model"><i class="fa fa-check"></i><b>4.7</b> In-Class Exercise: Use Lavaan to estimate and interpret the following model</a></li>
<li class="chapter" data-level="4.8" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#exercise-eating-disorder-mediation-analysis"><i class="fa fa-check"></i><b>4.8</b> Exercise: Eating Disorder Mediation Analysis</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#step-1-labeling-and-defining-the-parameters"><i class="fa fa-check"></i><b>4.8.1</b> Step 1: Labeling and defining the parameters</a></li>
<li class="chapter" data-level="4.8.2" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#step-2-fix-all-disturbance-covariances-at-0"><i class="fa fa-check"></i><b>4.8.2</b> Step 2: Fix all disturbance covariances at 0</a></li>
<li class="chapter" data-level="4.8.3" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#step-3-define-new-terms-for-mediation-effects"><i class="fa fa-check"></i><b>4.8.3</b> Step 3: Define new terms for mediation effects</a></li>
<li class="chapter" data-level="4.8.4" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#step-4-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>4.8.4</b> Step 4: Bootstrap confidence intervals:</a></li>
<li class="chapter" data-level="4.8.5" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#step-5-print-and-interpret-the-mediation-effects"><i class="fa fa-check"></i><b>4.8.5</b> Step 5: Print and interpret the mediation effects;</a></li>
<li class="chapter" data-level="4.8.6" data-path="lavaan-lab-2-mediation-and-indirect-effects.html"><a href="lavaan-lab-2-mediation-and-indirect-effects.html#plot-it"><i class="fa fa-check"></i><b>4.8.6</b> Plot it!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html"><i class="fa fa-check"></i><b>5</b> Lavaan Lab 3: Moderation and Conditional Effects</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#reading-in-datasets"><i class="fa fa-check"></i><b>5.1</b> Reading-In Datasets</a></li>
<li class="chapter" data-level="5.2" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#interactions-in-regression-using-lm"><i class="fa fa-check"></i><b>5.2</b> Interactions in Regression Using lm()</a></li>
<li class="chapter" data-level="5.3" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#interactions-in-lavaan"><i class="fa fa-check"></i><b>5.3</b> Interactions in Lavaan</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#important-note"><i class="fa fa-check"></i><b>5.3.1</b> IMPORTANT NOTE</a></li>
<li class="chapter" data-level="5.3.2" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#follow-the-equation-of-y-depression"><i class="fa fa-check"></i><b>5.3.2</b> Follow the equation of Y (Depression):</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#visual-inspection-of-interactions"><i class="fa fa-check"></i><b>5.4</b> Visual inspection of interactions</a></li>
<li class="chapter" data-level="5.5" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#centering-continuous-moderator"><i class="fa fa-check"></i><b>5.5</b> Centering Continuous Moderator</a></li>
<li class="chapter" data-level="5.6" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#interactions-in-lavaan-continuous-moderator"><i class="fa fa-check"></i><b>5.6</b> Interactions in Lavaan (Continuous Moderator)</a></li>
<li class="chapter" data-level="5.7" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>5.7</b> Simple Slopes Analysis</a></li>
<li class="chapter" data-level="5.8" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#visual-inspection-of-interactions-lm-approach"><i class="fa fa-check"></i><b>5.8</b> Visual inspection of interactions (lm approach)</a></li>
<li class="chapter" data-level="5.9" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#johnson-neyman-interval"><i class="fa fa-check"></i><b>5.9</b> JOHNSON-NEYMAN INTERVAL</a></li>
<li class="chapter" data-level="5.10" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#exercise-how-framing-affects-justifications-for-giving-or-withholding-aid-to-disaster-victims"><i class="fa fa-check"></i><b>5.10</b> Exercise: How Framing Affects Justifications for Giving or Withholding Aid to Disaster Victims</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#data-prep"><i class="fa fa-check"></i><b>5.10.1</b> Data Prep</a></li>
<li class="chapter" data-level="5.10.2" data-path="lavaan-lab-3-moderation-and-conditional-effects.html"><a href="lavaan-lab-3-moderation-and-conditional-effects.html#moderation-with-a-binary-moderator"><i class="fa fa-check"></i><b>5.10.2</b> Moderation with a binary moderator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><i class="fa fa-check"></i><b>6</b> Lavaan Lab 4: Mediated Moderation &amp; Moderated Mediation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#part-1-mediated-moderation-indirect-conditional-effect"><i class="fa fa-check"></i><b>6.1</b> PART 1: Mediated Moderation (Indirect Conditional effect)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-1-read-in-data"><i class="fa fa-check"></i><b>6.1.1</b> Step 1: Read-in Data</a></li>
<li class="chapter" data-level="6.1.2" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-2-create-the-interaction-term-for-moderation-analysis"><i class="fa fa-check"></i><b>6.1.2</b> Step 2: Create the interaction term for Moderation Analysis</a></li>
<li class="chapter" data-level="6.1.3" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-3-write-the-syntax-and-fit-the-model"><i class="fa fa-check"></i><b>6.1.3</b> Step 3: Write the syntax and Fit the model</a></li>
<li class="chapter" data-level="6.1.4" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-4-bootstrap-version"><i class="fa fa-check"></i><b>6.1.4</b> Step 4: Bootstrap Version</a></li>
<li class="chapter" data-level="6.1.5" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-5-effect-size-measures"><i class="fa fa-check"></i><b>6.1.5</b> Step 5: Effect size measures</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#part-2-moderated-mediation-conditional-indirect-effect"><i class="fa fa-check"></i><b>6.2</b> PART 2: Moderated Mediation (Conditional Indirect effect)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-1-product-term"><i class="fa fa-check"></i><b>6.2.1</b> Step 1: Product Term</a></li>
<li class="chapter" data-level="6.2.2" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-2-write-the-syntax-and-fit-the-model"><i class="fa fa-check"></i><b>6.2.2</b> Step 2: Write the syntax and Fit the model</a></li>
<li class="chapter" data-level="6.2.3" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-3-bootstrap-version"><i class="fa fa-check"></i><b>6.2.3</b> Step 3: Bootstrap Version</a></li>
<li class="chapter" data-level="6.2.4" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-4-simple-slopes"><i class="fa fa-check"></i><b>6.2.4</b> Step 4: Simple Slopes</a></li>
<li class="chapter" data-level="6.2.5" data-path="lavaan-lab-4-mediated-moderation-moderated-mediation.html"><a href="lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-5-johnson-neyman-interval"><i class="fa fa-check"></i><b>6.2.5</b> Step 5 JOHNSON-NEYMAN INTERVAL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><i class="fa fa-check"></i><b>7</b> R Lab on Disaster Dataset (Chapman and Lickel, 2016)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#data-prep-1"><i class="fa fa-check"></i><b>7.1</b> Data Prep</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#scatterplot-matrix"><i class="fa fa-check"></i><b>7.1.1</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="7.1.2" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#p-value-or-bootstrapped-confidence-interval"><i class="fa fa-check"></i><b>7.1.2</b> p-value or bootstrapped confidence interval?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-1-simple-linear-regression-model"><i class="fa fa-check"></i><b>7.2</b> Model 1: Simple Linear Regression Model</a></li>
<li class="chapter" data-level="7.3" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-2-simple-mediation-model"><i class="fa fa-check"></i><b>7.3</b> Model 2: Simple Mediation Model</a></li>
<li class="chapter" data-level="7.4" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-3-simple-moderation-model"><i class="fa fa-check"></i><b>7.4</b> Model 3: Simple Moderation Model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#johnson-neyman-interval-1"><i class="fa fa-check"></i><b>7.4.1</b> JOHNSON-NEYMAN INTERVAL</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-4a-moderated-mediation-model---path-a-only"><i class="fa fa-check"></i><b>7.5</b> Model 4a: Moderated Mediation Model - Path a only</a></li>
<li class="chapter" data-level="7.6" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-4b-moderated-mediation-model---path-b-only"><i class="fa fa-check"></i><b>7.6</b> Model 4b: Moderated Mediation Model - Path b only</a></li>
<li class="chapter" data-level="7.7" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-4c-moderation-mediation-model---path-cprime-only"><i class="fa fa-check"></i><b>7.7</b> Model 4c: Moderation &amp; Mediation Model - Path cprime only</a></li>
<li class="chapter" data-level="7.8" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-4d-moderated-mediation-model---path-a-and-cprime"><i class="fa fa-check"></i><b>7.8</b> Model 4d: Moderated Mediation Model - Path a and cprime</a></li>
<li class="chapter" data-level="7.9" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-4e-moderated-mediation-model---path-b-and-cprime"><i class="fa fa-check"></i><b>7.9</b> Model 4e: Moderated Mediation Model - Path b and cprime</a></li>
<li class="chapter" data-level="7.10" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-4f-moderated-mediation-model---path-a-and-b"><i class="fa fa-check"></i><b>7.10</b> Model 4f: Moderated Mediation Model - Path a and b</a></li>
<li class="chapter" data-level="7.11" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#model-4g-moderated-mediation-model---path-a-b-and-cprime"><i class="fa fa-check"></i><b>7.11</b> Model 4g: Moderated Mediation Model - Path a, b, and cprime</a></li>
<li class="chapter" data-level="7.12" data-path="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html"><a href="r-lab-on-disaster-dataset-chapman-and-lickel-2016.html#conclusions"><i class="fa fa-check"></i><b>7.12</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html"><i class="fa fa-check"></i><b>8</b> Lavaan Lab 5: One-factor CFA Model</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#data-prep-2"><i class="fa fa-check"></i><b>8.1</b> Data Prep</a></li>
<li class="chapter" data-level="8.2" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#part-i-one-factor-cfa-fixed-loading"><i class="fa fa-check"></i><b>8.2</b> PART I: One-Factor CFA, Fixed Loading</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#fixed-loading-aka-marker-variable-method."><i class="fa fa-check"></i><b>8.2.1</b> Fixed Loading, AKA Marker Variable method.</a></li>
<li class="chapter" data-level="8.2.2" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#change-marker-indicator"><i class="fa fa-check"></i><b>8.2.2</b> Change marker indicator</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#part-ii-one-factor-cfa-fixed-factor-variance"><i class="fa fa-check"></i><b>8.3</b> PART II: One-Factor CFA, Fixed Factor Variance</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#fixed-factor-method"><i class="fa fa-check"></i><b>8.3.1</b> Fixed Factor Method</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#exercise-one-factor-cfa-model"><i class="fa fa-check"></i><b>8.4</b> Exercise: One-factor CFA Model</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#fixed-loading"><i class="fa fa-check"></i><b>8.4.1</b> Fixed Loading</a></li>
<li class="chapter" data-level="8.4.2" data-path="lavaan-lab-5-one-factor-cfa-model.html"><a href="lavaan-lab-5-one-factor-cfa-model.html#fixed-factor"><i class="fa fa-check"></i><b>8.4.2</b> Fixed Factor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html"><i class="fa fa-check"></i><b>9</b> Lavaan Lab 6: Two-factor CFA Model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#data-prep-3"><i class="fa fa-check"></i><b>9.1</b> Data Prep</a></li>
<li class="chapter" data-level="9.2" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#part-i-two-factor-cfa-fixed-loading"><i class="fa fa-check"></i><b>9.2</b> PART I: Two-Factor CFA, Fixed Loading</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#fixed-loading-aka-marker-variable-method.-1"><i class="fa fa-check"></i><b>9.2.1</b> Fixed Loading, AKA Marker Variable method.</a></li>
<li class="chapter" data-level="9.2.2" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#how-well-does-this-model-fit-to-the-data"><i class="fa fa-check"></i><b>9.2.2</b> How well does this model fit to the data?</a></li>
<li class="chapter" data-level="9.2.3" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#fundamental-equation-of-sem"><i class="fa fa-check"></i><b>9.2.3</b> Fundamental Equation of SEM</a></li>
<li class="chapter" data-level="9.2.4" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#interpretion"><i class="fa fa-check"></i><b>9.2.4</b> Interpretion</a></li>
<li class="chapter" data-level="9.2.5" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#standardized-solutions-std.lv-vs.-std.all"><i class="fa fa-check"></i><b>9.2.5</b> Standardized solutions: Std.lv vs. Std.all</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#part-ii-two-factor-cfa-fixed-factor-variance"><i class="fa fa-check"></i><b>9.3</b> PART II: Two-Factor CFA, Fixed Factor Variance</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="lavaan-lab-6-two-factor-cfa-model.html"><a href="lavaan-lab-6-two-factor-cfa-model.html#fixed-factor-method-1"><i class="fa fa-check"></i><b>9.3.1</b> Fixed Factor Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lavaan-lab-7-two-factor-sr-model.html"><a href="lavaan-lab-7-two-factor-sr-model.html"><i class="fa fa-check"></i><b>10</b> Lavaan Lab 7: Two-factor SR Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lavaan-lab-7-two-factor-sr-model.html"><a href="lavaan-lab-7-two-factor-sr-model.html#data-prep-4"><i class="fa fa-check"></i><b>10.1</b> Data Prep</a></li>
<li class="chapter" data-level="10.2" data-path="lavaan-lab-7-two-factor-sr-model.html"><a href="lavaan-lab-7-two-factor-sr-model.html#part-i-two-factor-sr-fixed-loading"><i class="fa fa-check"></i><b>10.2</b> PART I: Two-Factor SR, Fixed Loading</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="lavaan-lab-7-two-factor-sr-model.html"><a href="lavaan-lab-7-two-factor-sr-model.html#fixed-loading-aka-marker-variable-method.-2"><i class="fa fa-check"></i><b>10.2.1</b> Fixed Loading, AKA Marker Variable method.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="lavaan-lab-7-two-factor-sr-model.html"><a href="lavaan-lab-7-two-factor-sr-model.html#part-ii-two-factor-sr-fixed-factor-variance"><i class="fa fa-check"></i><b>10.3</b> PART II: Two-Factor SR, Fixed Factor Variance</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="lavaan-lab-7-two-factor-sr-model.html"><a href="lavaan-lab-7-two-factor-sr-model.html#fixed-factor-method-2"><i class="fa fa-check"></i><b>10.3.1</b> Fixed Factor Method</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="lavaan-lab-7-two-factor-sr-model.html"><a href="lavaan-lab-7-two-factor-sr-model.html#part-iii-exercise-what-fun-3-factor-sr-model"><i class="fa fa-check"></i><b>10.4</b> PART III: Exercise (what fun!): 3-Factor SR Model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html"><i class="fa fa-check"></i><b>11</b> Lavaan Lab 8: Estimation Methods</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#part-i-hypothetical-example"><i class="fa fa-check"></i><b>11.1</b> PART I: Hypothetical Example</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#one-factor-cfa-model"><i class="fa fa-check"></i><b>11.1.1</b> One-factor CFA model</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#part-ii-uls-on-the-positive-affect-example"><i class="fa fa-check"></i><b>11.2</b> PART II: ULS on the Positive Affect Example</a></li>
<li class="chapter" data-level="11.3" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#part-iii-calculate-uls-test-statistic-manually"><i class="fa fa-check"></i><b>11.3</b> PART III: Calculate ULS test statistic manually</a></li>
<li class="chapter" data-level="11.4" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#part-iv-ml-vs-uls-vs-wls"><i class="fa fa-check"></i><b>11.4</b> PART IV: ML vs ULS vs WLS</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#ml-estimation"><i class="fa fa-check"></i><b>11.4.1</b> ML Estimation</a></li>
<li class="chapter" data-level="11.4.2" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#wls-estimation"><i class="fa fa-check"></i><b>11.4.2</b> WLS Estimation</a></li>
<li class="chapter" data-level="11.4.3" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#compare-the-parameter-estimates"><i class="fa fa-check"></i><b>11.4.3</b> Compare the parameter estimates</a></li>
<li class="chapter" data-level="11.4.4" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#compare-the-standard-errors"><i class="fa fa-check"></i><b>11.4.4</b> Compare the standard errors:</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="lavaan-lab-8-estimation-methods.html"><a href="lavaan-lab-8-estimation-methods.html#part-v-improper-solutions"><i class="fa fa-check"></i><b>11.5</b> PART V: Improper Solutions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html"><i class="fa fa-check"></i><b>12</b> Lavaan Lab 9: Model Fit Part I (Test Statistics)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#part-i-robust-ml-on-the-positive-affect-example"><i class="fa fa-check"></i><b>12.1</b> PART I: Robust ML on the Positive Affect Example</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#mean-corrected-statistic-t_m"><i class="fa fa-check"></i><b>12.1.1</b> Mean corrected statistic (T_M)</a></li>
<li class="chapter" data-level="12.1.2" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#mean-and-variance-adjusted-statistic-t_mv"><i class="fa fa-check"></i><b>12.1.2</b> Mean and variance adjusted statistic (T_MV)</a></li>
<li class="chapter" data-level="12.1.3" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#yuan-bentler-test-statistic-t_mlr"><i class="fa fa-check"></i><b>12.1.3</b> Yuan-Bentler test statistic (T_MLR)</a></li>
<li class="chapter" data-level="12.1.4" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#small-sample-correction---f-test"><i class="fa fa-check"></i><b>12.1.4</b> Small sample correction - F test</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#part-ii-nested-model-comparison"><i class="fa fa-check"></i><b>12.2</b> PART II: Nested Model Comparison</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#one-factor-model"><i class="fa fa-check"></i><b>12.2.1</b> One-factor model</a></li>
<li class="chapter" data-level="12.2.2" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#plotting"><i class="fa fa-check"></i><b>12.2.2</b> Plotting</a></li>
<li class="chapter" data-level="12.2.3" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#comparing-nested-models"><i class="fa fa-check"></i><b>12.2.3</b> Comparing Nested Models</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#part-iii-exercises-more-nested-models"><i class="fa fa-check"></i><b>12.3</b> PART III: Exercises: More Nested Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#exercises-compare-the-base-model-fixedindtwofacrun-to"><i class="fa fa-check"></i><b>12.3.1</b> Exercises: Compare the base model (fixedIndTwoFacRun) to</a></li>
<li class="chapter" data-level="12.3.2" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#model-2-orthogonal-factors"><i class="fa fa-check"></i><b>12.3.2</b> Model 2: Orthogonal Factors</a></li>
<li class="chapter" data-level="12.3.3" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#model-3-cross-loading"><i class="fa fa-check"></i><b>12.3.3</b> Model 3: Cross loading</a></li>
<li class="chapter" data-level="12.3.4" data-path="lavaan-lab-9-model-fit-part-i-test-statistics.html"><a href="lavaan-lab-9-model-fit-part-i-test-statistics.html#model-4-correlated-unique-factors"><i class="fa fa-check"></i><b>12.3.4</b> Model 4: Correlated Unique Factors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><i class="fa fa-check"></i><b>13</b> Lavaan Lab 10: Model Fit Part II (Fit Indices)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#part-i-fit-indices"><i class="fa fa-check"></i><b>13.1</b> PART I: Fit Indices</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#rmsea"><i class="fa fa-check"></i><b>13.1.1</b> RMSEA</a></li>
<li class="chapter" data-level="13.1.2" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#srmr"><i class="fa fa-check"></i><b>13.1.2</b> SRMR</a></li>
<li class="chapter" data-level="13.1.3" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#null-model-mo"><i class="fa fa-check"></i><b>13.1.3</b> Null Model MO</a></li>
<li class="chapter" data-level="13.1.4" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#cfitli"><i class="fa fa-check"></i><b>13.1.4</b> CFI/TLI</a></li>
<li class="chapter" data-level="13.1.5" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#loglikelihood"><i class="fa fa-check"></i><b>13.1.5</b> Loglikelihood</a></li>
<li class="chapter" data-level="13.1.6" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#aicbic"><i class="fa fa-check"></i><b>13.1.6</b> AIC/BIC</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#part-ii-exercise"><i class="fa fa-check"></i><b>13.2</b> PART II: Exercise</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#part-i-plot-the-distributions-of-all-indicators"><i class="fa fa-check"></i><b>13.2.1</b> PART I: Plot the distributions of all indicators</a></li>
<li class="chapter" data-level="13.2.2" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#part-ii-write-out-the-model-syntax-for-two-factor-model"><i class="fa fa-check"></i><b>13.2.2</b> PART II: Write out the model syntax for two-factor model</a></li>
<li class="chapter" data-level="13.2.3" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#part-iii-fit-the-two-factor-model"><i class="fa fa-check"></i><b>13.2.3</b> PART III: Fit the two-factor model</a></li>
<li class="chapter" data-level="13.2.4" data-path="lavaan-lab-10-model-fit-part-ii-fit-indices.html"><a href="lavaan-lab-10-model-fit-part-ii-fit-indices.html#part-iv-interpret-the-chisquare-statistic-and-fit-indices"><i class="fa fa-check"></i><b>13.2.4</b> PART IV: Interpret the chisquare statistic and fit indices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><i class="fa fa-check"></i><b>14</b> Lavaan Lab 11: Model Local Fitting and Model Modifications</a>
<ul>
<li class="chapter" data-level="14.1" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#part-i-local-fit-with-residuals"><i class="fa fa-check"></i><b>14.1</b> PART I: Local Fit with Residuals</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#unstandardized-residuals"><i class="fa fa-check"></i><b>14.1.1</b> Unstandardized residuals</a></li>
<li class="chapter" data-level="14.1.2" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#standardized-residuals"><i class="fa fa-check"></i><b>14.1.2</b> Standardized residuals</a></li>
<li class="chapter" data-level="14.1.3" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#normalized-residuals"><i class="fa fa-check"></i><b>14.1.3</b> Normalized residuals</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#part-ii-modification-indices"><i class="fa fa-check"></i><b>14.2</b> PART II: Modification Indices</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#modified-model-1"><i class="fa fa-check"></i><b>14.2.1</b> Modified Model 1:</a></li>
<li class="chapter" data-level="14.2.2" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#modified-model-2_1"><i class="fa fa-check"></i><b>14.2.2</b> Modified Model 2_1:</a></li>
<li class="chapter" data-level="14.2.3" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#modified-model-2_2"><i class="fa fa-check"></i><b>14.2.3</b> Modified Model 2_2:</a></li>
<li class="chapter" data-level="14.2.4" data-path="lavaan-lab-11-model-local-fitting-and-model-modifications.html"><a href="lavaan-lab-11-model-local-fitting-and-model-modifications.html#modified-model-3"><i class="fa fa-check"></i><b>14.2.4</b> Modified Model 3:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="lavaan-lab-12-sem-for-missing-data.html"><a href="lavaan-lab-12-sem-for-missing-data.html"><i class="fa fa-check"></i><b>15</b> Lavaan Lab 12: SEM for Missing Data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="lavaan-lab-12-sem-for-missing-data.html"><a href="lavaan-lab-12-sem-for-missing-data.html#part-i-generate-some-missing-data"><i class="fa fa-check"></i><b>15.1</b> PART I: Generate some missing data</a></li>
<li class="chapter" data-level="15.2" data-path="lavaan-lab-12-sem-for-missing-data.html"><a href="lavaan-lab-12-sem-for-missing-data.html#part-ii-visualization-of-missing-data-patterns-nice-to-have"><i class="fa fa-check"></i><b>15.2</b> PART II: Visualization of missing data patterns (nice-to-have)</a></li>
<li class="chapter" data-level="15.3" data-path="lavaan-lab-12-sem-for-missing-data.html"><a href="lavaan-lab-12-sem-for-missing-data.html#part-iii-build-a-cfa-model-with-missing-data"><i class="fa fa-check"></i><b>15.3</b> PART III: Build a CFA model with missing data</a></li>
<li class="chapter" data-level="15.4" data-path="lavaan-lab-12-sem-for-missing-data.html"><a href="lavaan-lab-12-sem-for-missing-data.html#part-iv-addressing-missing-data"><i class="fa fa-check"></i><b>15.4</b> PART IV: Addressing missing data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="lavaan-lab-12-sem-for-missing-data.html"><a href="lavaan-lab-12-sem-for-missing-data.html#fiml"><i class="fa fa-check"></i><b>15.4.1</b> FIML</a></li>
<li class="chapter" data-level="15.4.2" data-path="lavaan-lab-12-sem-for-missing-data.html"><a href="lavaan-lab-12-sem-for-missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>15.4.2</b> Multiple Imputation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html"><a href="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html"><i class="fa fa-check"></i><b>16</b> Lavaan Lab 13: SEM for Nonnormal and Categorical Data</a>
<ul>
<li class="chapter" data-level="16.1" data-path="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html"><a href="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html#part-i-nonnormality-diagnosis"><i class="fa fa-check"></i><b>16.1</b> PART I: Nonnormality Diagnosis</a></li>
<li class="chapter" data-level="16.2" data-path="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html"><a href="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html#part-ii-robust-corrections"><i class="fa fa-check"></i><b>16.2</b> PART II: Robust corrections</a></li>
<li class="chapter" data-level="16.3" data-path="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html"><a href="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html#part-iii-categorical-data-analysis-in-lavaan"><i class="fa fa-check"></i><b>16.3</b> PART III: Categorical Data Analysis in Lavaan</a></li>
<li class="chapter" data-level="16.4" data-path="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html"><a href="lavaan-lab-13-sem-for-nonnormal-and-categorical-data.html#part-iv-what-if-you-have-it-all"><i class="fa fa-check"></i><b>16.4</b> PART IV: What if you have it all?</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html"><i class="fa fa-check"></i><b>17</b> Lavaan Lab 14: Measurement Invariance</a>
<ul>
<li class="chapter" data-level="17.1" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#part-i-multi-group-analyses-done-incorrectly"><i class="fa fa-check"></i><b>17.1</b> PART I: Multi-Group Analyses, Done Incorrectly</a></li>
<li class="chapter" data-level="17.2" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#part-ii-testing-measurement-invariance"><i class="fa fa-check"></i><b>17.2</b> PART II: Testing Measurement Invariance</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#step-1-configural-invariance"><i class="fa fa-check"></i><b>17.2.1</b> step 1: Configural invariance</a></li>
<li class="chapter" data-level="17.2.2" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#step-2-metric-weak-invariance"><i class="fa fa-check"></i><b>17.2.2</b> step 2: Metric (weak) invariance</a></li>
<li class="chapter" data-level="17.2.3" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#step-3-scalar-strong-invariance"><i class="fa fa-check"></i><b>17.2.3</b> step 3: Scalar (strong) Invariance</a></li>
<li class="chapter" data-level="17.2.4" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#step-4-optional-residual-variance-strict-invariance"><i class="fa fa-check"></i><b>17.2.4</b> step 4: (Optional) Residual variance (strict) invariance</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#part-iii-shortcut-to-performing-mi"><i class="fa fa-check"></i><b>17.3</b> PART III: Shortcut to performing MI</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#measurementinvariance"><i class="fa fa-check"></i><b>17.3.1</b> measurementInvariance()</a></li>
<li class="chapter" data-level="17.3.2" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#measeq.syntax"><i class="fa fa-check"></i><b>17.3.2</b> measEq.syntax()</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#part-iv-multi-group-cfa-modeling-done-right"><i class="fa fa-check"></i><b>17.4</b> PART IV: Multi-Group CFA Modeling, done right</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#statistical-test-of-equal-factor-means"><i class="fa fa-check"></i><b>17.4.1</b> Statistical Test of Equal Factor Means:</a></li>
<li class="chapter" data-level="17.4.2" data-path="lavaan-lab-14-measurement-invariance.html"><a href="lavaan-lab-14-measurement-invariance.html#statistical-test-of-equal-regression-coefficients"><i class="fa fa-check"></i><b>17.4.2</b> Statistical Test of Equal Regression Coefficients:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html"><i class="fa fa-check"></i><b>18</b> Lavaan Lab 15: MIMIC &amp; Longitudinal Invariance</a>
<ul>
<li class="chapter" data-level="18.1" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#part-i-partial-invariance"><i class="fa fa-check"></i><b>18.1</b> PART I: Partial Invariance</a></li>
<li class="chapter" data-level="18.2" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#part-ii-mimic"><i class="fa fa-check"></i><b>18.2</b> PART II: MIMIC</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#test-metric-invariance"><i class="fa fa-check"></i><b>18.2.1</b> Test Metric Invariance</a></li>
<li class="chapter" data-level="18.2.2" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#test-scalar-invariance"><i class="fa fa-check"></i><b>18.2.2</b> Test Scalar Invariance</a></li>
<li class="chapter" data-level="18.2.3" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#test-the-hypothesis-of-equal-factor-means"><i class="fa fa-check"></i><b>18.2.3</b> Test The Hypothesis of Equal Factor Means:</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#part-iii-longitudinal-invariance"><i class="fa fa-check"></i><b>18.3</b> PART III: Longitudinal Invariance</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#step-1-configural-invariance-1"><i class="fa fa-check"></i><b>18.3.1</b> step 1: Configural invariance</a></li>
<li class="chapter" data-level="18.3.2" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#step-1.5-threshold-invariance-for-categorical-indicators-only"><i class="fa fa-check"></i><b>18.3.2</b> step 1.5: Threshold invariance (for categorical indicators only)</a></li>
<li class="chapter" data-level="18.3.3" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#recommended-practice-fit-one-invariance-model-at-a-time"><i class="fa fa-check"></i><b>18.3.3</b> RECOMMENDED PRACTICE: fit one invariance model at a time</a></li>
<li class="chapter" data-level="18.3.4" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#step-2-metric-weak-invariance-1"><i class="fa fa-check"></i><b>18.3.4</b> step 2: Metric (weak) invariance</a></li>
<li class="chapter" data-level="18.3.5" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#step-3-scalar-strong-invariance-1"><i class="fa fa-check"></i><b>18.3.5</b> step 3: Scalar (strong) Invariance</a></li>
<li class="chapter" data-level="18.3.6" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#step-4-residual-variance-strict-invariance"><i class="fa fa-check"></i><b>18.3.6</b> step 4: Residual variance (strict) invariance</a></li>
<li class="chapter" data-level="18.3.7" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#shortcut-function"><i class="fa fa-check"></i><b>18.3.7</b> Shortcut Function</a></li>
<li class="chapter" data-level="18.3.8" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#not-recommended-fit-several-invariance-models-at-once"><i class="fa fa-check"></i><b>18.3.8</b> NOT RECOMMENDED: fit several invariance models at once</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#part-iv-exercises-mimic"><i class="fa fa-check"></i><b>18.4</b> PART IV: Exercises: MIMIC</a></li>
<li class="chapter" data-level="18.5" data-path="lavaan-lab-15-mimic-longitudinal-invariance.html"><a href="lavaan-lab-15-mimic-longitudinal-invariance.html#part-v-exercises-longitudinal-invariance"><i class="fa fa-check"></i><b>18.5</b> PART V: Exercises: Longitudinal Invariance</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html"><i class="fa fa-check"></i><b>19</b> Lavaan Lab 16: Latent Growth Models</a>
<ul>
<li class="chapter" data-level="19.1" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#part-i-spaghetti-plot"><i class="fa fa-check"></i><b>19.1</b> PART I: Spaghetti Plot</a></li>
<li class="chapter" data-level="19.2" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#part-ii-growth-models"><i class="fa fa-check"></i><b>19.2</b> PART II: Growth Models</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#no-growth-model"><i class="fa fa-check"></i><b>19.2.1</b> 1. No growth model</a></li>
<li class="chapter" data-level="19.2.2" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#linear-growth-model"><i class="fa fa-check"></i><b>19.2.2</b> 2. Linear growth model</a></li>
<li class="chapter" data-level="19.2.3" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#quadratic-growth-model"><i class="fa fa-check"></i><b>19.2.3</b> 3. Quadratic growth model</a></li>
<li class="chapter" data-level="19.2.4" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#latent-basis-growth-model-extension-of-linear-growth-model"><i class="fa fa-check"></i><b>19.2.4</b> 4. Latent basis growth model (extension of linear growth model)</a></li>
<li class="chapter" data-level="19.2.5" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#spline-growth-model"><i class="fa fa-check"></i><b>19.2.5</b> 5. Spline Growth Model</a></li>
<li class="chapter" data-level="19.2.6" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#model-comparison"><i class="fa fa-check"></i><b>19.2.6</b> Model Comparison</a></li>
<li class="chapter" data-level="19.2.7" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#final-model-spline-growth-model-with-a-binary-treatment-predictor"><i class="fa fa-check"></i><b>19.2.7</b> 6. Final Model: Spline Growth Model with a binary treatment predictor</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#part-iii-lgm-on-latent-variables"><i class="fa fa-check"></i><b>19.3</b> PART III: LGM on Latent Variables</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#example"><i class="fa fa-check"></i><b>19.3.1</b> Example</a></li>
<li class="chapter" data-level="19.3.2" data-path="lavaan-lab-16-latent-growth-models.html"><a href="lavaan-lab-16-latent-growth-models.html#exercise"><i class="fa fa-check"></i><b>19.3.2</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="lavaan-lab-17-second-order-and-bifactor-models.html"><a href="lavaan-lab-17-second-order-and-bifactor-models.html"><i class="fa fa-check"></i><b>20</b> Lavaan Lab 17: Second-order and Bifactor Models</a>
<ul>
<li class="chapter" data-level="20.1" data-path="lavaan-lab-17-second-order-and-bifactor-models.html"><a href="lavaan-lab-17-second-order-and-bifactor-models.html#part-i-unidimensional-model"><i class="fa fa-check"></i><b>20.1</b> PART I: Unidimensional model</a></li>
<li class="chapter" data-level="20.2" data-path="lavaan-lab-17-second-order-and-bifactor-models.html"><a href="lavaan-lab-17-second-order-and-bifactor-models.html#part-ii-correlated-factors-model"><i class="fa fa-check"></i><b>20.2</b> PART II: Correlated factors model</a></li>
<li class="chapter" data-level="20.3" data-path="lavaan-lab-17-second-order-and-bifactor-models.html"><a href="lavaan-lab-17-second-order-and-bifactor-models.html#part-iii-second-order-factor-model"><i class="fa fa-check"></i><b>20.3</b> PART III: Second-order factor Model</a></li>
<li class="chapter" data-level="20.4" data-path="lavaan-lab-17-second-order-and-bifactor-models.html"><a href="lavaan-lab-17-second-order-and-bifactor-models.html#part-iv-bifactor-model"><i class="fa fa-check"></i><b>20.4</b> PART IV: Bifactor Model</a></li>
<li class="chapter" data-level="20.5" data-path="lavaan-lab-17-second-order-and-bifactor-models.html"><a href="lavaan-lab-17-second-order-and-bifactor-models.html#part-v-model-comparison"><i class="fa fa-check"></i><b>20.5</b> PART V: Model Comparison</a></li>
<li class="chapter" data-level="20.6" data-path="lavaan-lab-17-second-order-and-bifactor-models.html"><a href="lavaan-lab-17-second-order-and-bifactor-models.html#exercise-mental-ability-scale"><i class="fa fa-check"></i><b>20.6</b> Exercise: Mental Ability Scale</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="lavaan-lab-18-cfa-of-mtmm-matrix.html"><a href="lavaan-lab-18-cfa-of-mtmm-matrix.html"><i class="fa fa-check"></i><b>21</b> Lavaan Lab 18: CFA of MTMM Matrix</a>
<ul>
<li class="chapter" data-level="21.1" data-path="lavaan-lab-18-cfa-of-mtmm-matrix.html"><a href="lavaan-lab-18-cfa-of-mtmm-matrix.html#part-i-correlated-methods-specification"><i class="fa fa-check"></i><b>21.1</b> PART I: Correlated methods specification</a></li>
<li class="chapter" data-level="21.2" data-path="lavaan-lab-18-cfa-of-mtmm-matrix.html"><a href="lavaan-lab-18-cfa-of-mtmm-matrix.html#part-ii-correlated-uniqueness-specification"><i class="fa fa-check"></i><b>21.2</b> PART II: Correlated uniqueness specification</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html"><i class="fa fa-check"></i><b>22</b> Lavaan Lab 19: Multilevel SEM</a>
<ul>
<li class="chapter" data-level="22.1" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-i-multilevel-cfa-1-within-only-construct"><i class="fa fa-check"></i><b>22.1</b> PART I: Multilevel CFA 1: within-only construct</a></li>
<li class="chapter" data-level="22.2" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-ii-multilevel-cfa-2-between-only-construct"><i class="fa fa-check"></i><b>22.2</b> PART II: Multilevel CFA 2: Between-only construct</a></li>
<li class="chapter" data-level="22.3" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-iii-multilevel-cfa-3-shared-cross-level-construct"><i class="fa fa-check"></i><b>22.3</b> PART III: Multilevel CFA 3: Shared cross-level construct</a></li>
<li class="chapter" data-level="22.4" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-iv-multilevel-cfa-4-configural-construct"><i class="fa fa-check"></i><b>22.4</b> PART IV: Multilevel CFA 4: Configural construct</a></li>
<li class="chapter" data-level="22.5" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-v-multilevel-cfa-5-shared-configural-construct"><i class="fa fa-check"></i><b>22.5</b> PART V: Multilevel CFA 5: Shared + Configural construct</a></li>
<li class="chapter" data-level="22.6" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-vi-model-comparison"><i class="fa fa-check"></i><b>22.6</b> PART VI: Model Comparison</a></li>
<li class="chapter" data-level="22.7" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-vii-adding-covariates-to-multilevel-sem"><i class="fa fa-check"></i><b>22.7</b> PART VII: Adding Covariates to Multilevel SEM</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#model-a-adding-a-within-only-covariate"><i class="fa fa-check"></i><b>22.7.1</b> Model A: Adding a within-only covariate</a></li>
<li class="chapter" data-level="22.7.2" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#model-b-adding-a-between-only-covariate"><i class="fa fa-check"></i><b>22.7.2</b> Model B: Adding a between-only covariate</a></li>
<li class="chapter" data-level="22.7.3" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#model-c-adding-a-covariate-at-both-levels"><i class="fa fa-check"></i><b>22.7.3</b> Model C: Adding a covariate at both levels</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="lavaan-lab-19-multilevel-sem.html"><a href="lavaan-lab-19-multilevel-sem.html#part-vii-final-model"><i class="fa fa-check"></i><b>22.8</b> PART VII: Final Model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cookbook for Structural Equation Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lavaan-lab-19-multilevel-sem" class="section level1 hasAnchor" number="22">
<h1><span class="header-section-number">Chapter 22</span> Lavaan Lab 19: Multilevel SEM<a href="lavaan-lab-19-multilevel-sem.html#lavaan-lab-19-multilevel-sem" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this lab, we will:</p>
<ul>
<li>build a multilevel CFA model</li>
<li>add covariates at both the between and the within level</li>
</ul>
<p>Load up the lavaan library:</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="lavaan-lab-19-multilevel-sem.html#cb856-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code></pre></div>
<p>Let’s read in a Mplus example dataset from an online location</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="lavaan-lab-19-multilevel-sem.html#cb857-1" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://statmodel.com/usersguide/chap9/ex9.6.dat&quot;</span>)</span>
<span id="cb857-2"><a href="lavaan-lab-19-multilevel-sem.html#cb857-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;y1&quot;</span>, <span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>, <span class="st">&quot;y4&quot;</span>, <span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;clus&quot;</span>)</span></code></pre></div>
<p>Take a look at the matrix:</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="lavaan-lab-19-multilevel-sem.html#cb858-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Data)</span></code></pre></div>
<pre><code>##          y1        y2        y3        y4        x1        x2         w clus
## 1  2.203250  1.858861  1.738477  2.244863  1.142800 -0.796987 -0.149501    1
## 2  1.934917  2.127876  0.083120  2.509436  1.949033 -0.122764 -0.149501    1
## 3  0.321955  0.977231 -0.835405  0.558367 -0.716481 -0.767064 -0.149501    1
## 4  0.073154 -1.743092 -2.310271 -1.514332 -2.649131  0.637570 -0.149501    1
## 5 -1.214906  0.452618  0.372610 -1.790372 -0.262916  0.302564 -0.149501    1
## 6  0.298330 -1.820272  0.561335 -2.090582 -0.944963  1.363045  0.319335    2</code></pre>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="lavaan-lab-19-multilevel-sem.html#cb860-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Data)</span></code></pre></div>
<pre><code>## [1] 1000    8</code></pre>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="lavaan-lab-19-multilevel-sem.html#cb862-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(Data<span class="sc">$</span>clus))</span></code></pre></div>
<pre><code>## [1] 110</code></pre>
<ul>
<li>there are 1000 individual observations in 110 clusters</li>
<li>cluster sizes: 5, 10, 15</li>
<li>4 measures at the within level y1, y2, y3, y4</li>
<li>2 covariates at the within level: x1, x2</li>
<li>1 covariate at the between level: w</li>
</ul>
<!------------------------------>
<div id="part-i-multilevel-cfa-1-within-only-construct" class="section level2 hasAnchor" number="22.1">
<h2><span class="header-section-number">22.1</span> PART I: Multilevel CFA 1: within-only construct<a href="lavaan-lab-19-multilevel-sem.html#part-i-multilevel-cfa-1-within-only-construct" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<p>This model specifies the latent variable only at the within level:</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="lavaan-lab-19-multilevel-sem.html#cb864-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb864-2"><a href="lavaan-lab-19-multilevel-sem.html#cb864-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb864-3"><a href="lavaan-lab-19-multilevel-sem.html#cb864-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ y1 + y2 + y3 + y4</span></span>
<span id="cb864-4"><a href="lavaan-lab-19-multilevel-sem.html#cb864-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb864-5"><a href="lavaan-lab-19-multilevel-sem.html#cb864-5" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb864-6"><a href="lavaan-lab-19-multilevel-sem.html#cb864-6" aria-hidden="true" tabindex="-1"></a><span class="st">    y1 ~~ y1 + y2 + y3 + y4</span></span>
<span id="cb864-7"><a href="lavaan-lab-19-multilevel-sem.html#cb864-7" aria-hidden="true" tabindex="-1"></a><span class="st">    y2 ~~ y2 + y2 + y3</span></span>
<span id="cb864-8"><a href="lavaan-lab-19-multilevel-sem.html#cb864-8" aria-hidden="true" tabindex="-1"></a><span class="st">    y3 ~~ y3 + y4</span></span>
<span id="cb864-9"><a href="lavaan-lab-19-multilevel-sem.html#cb864-9" aria-hidden="true" tabindex="-1"></a><span class="st">    y4 ~~ y4</span></span>
<span id="cb864-10"><a href="lavaan-lab-19-multilevel-sem.html#cb864-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb864-11"><a href="lavaan-lab-19-multilevel-sem.html#cb864-11" aria-hidden="true" tabindex="-1"></a><span class="st">    # all variances and covariances are freely estimated</span></span>
<span id="cb864-12"><a href="lavaan-lab-19-multilevel-sem.html#cb864-12" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Fit the model:</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="lavaan-lab-19-multilevel-sem.html#cb865-1" aria-hidden="true" tabindex="-1"></a>model1fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model1, <span class="at">data =</span> Data, </span>
<span id="cb865-2"><a href="lavaan-lab-19-multilevel-sem.html#cb865-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>,</span>
<span id="cb865-3"><a href="lavaan-lab-19-multilevel-sem.html#cb865-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb865-4"><a href="lavaan-lab-19-multilevel-sem.html#cb865-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span>
<span id="cb865-5"><a href="lavaan-lab-19-multilevel-sem.html#cb865-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-6"><a href="lavaan-lab-19-multilevel-sem.html#cb865-6" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model1fit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 57 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        21
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                52.360      64.738
##   Degrees of freedom                                 3           3
##   P-value (Chi-square)                           0.000       0.000
##   Scaling correction factor                                  0.809
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2619.397    2815.244
##   Degrees of freedom                                12          12
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.930
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.981       0.978
##   Tucker-Lewis Index (TLI)                       0.924       0.912
##                                                                   
##   Robust Comparative Fit Index (CFI)                         0.981
##   Robust Tucker-Lewis Index (TLI)                            0.923
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -6900.518   -6900.518
##   Scaling correction factor                                  1.050
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -6874.338   -6874.338
##   Scaling correction factor                                  1.020
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               13843.036   13843.036
##   Bayesian (BIC)                             13946.099   13946.099
##   Sample-size adjusted Bayesian (BIC)        13879.402   13879.402
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.128       0.143
##   90 Percent confidence interval - lower         0.099       0.111
##   90 Percent confidence interval - upper         0.160       0.178
##   P-value RMSEA &lt;= 0.05                          0.000       0.000
##                                                                   
##   Robust RMSEA                                               0.129
##   90 Percent confidence interval - lower                     0.103
##   90 Percent confidence interval - upper                     0.157
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.022       0.022
##   SRMR (between covariance matrix)               0.334       0.334
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1                1.000                               1.568    0.843
##     y2                1.019    0.035   28.881    0.000    1.598    0.857
##     y3                0.995    0.041   24.267    0.000    1.560    0.832
##     y4                1.034    0.035   29.613    0.000    1.622    0.851
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.997    0.070   14.220    0.000    0.997    0.289
##    .y2                0.919    0.061   14.990    0.000    0.919    0.265
##    .y3                1.082    0.057   18.977    0.000    1.082    0.308
##    .y4                0.997    0.069   14.422    0.000    0.997    0.275
##     fw                2.458    0.186   13.209    0.000    1.000    1.000
## 
## 
## Level 2 [clus]:
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##  .y1 ~~                                                                 
##    .y2                0.069    0.027    2.558    0.011    0.069    0.935
##    .y3                0.080    0.027    2.916    0.004    0.080    1.141
##    .y4                0.052    0.024    2.157    0.031    0.052    0.764
##  .y2 ~~                                                                 
##    .y3                0.055    0.023    2.399    0.016    0.055    0.935
##  .y3 ~~                                                                 
##    .y4                0.040    0.026    1.537    0.124    0.040    0.727
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.063    0.089   -0.716    0.474   -0.063   -0.215
##    .y2               -0.060    0.088   -0.674    0.500   -0.060   -0.239
##    .y3               -0.026    0.086   -0.301    0.763   -0.026   -0.109
##    .y4               -0.005    0.089   -0.053    0.958   -0.005   -0.020
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.088    0.033    2.679    0.007    0.088    1.000
##    .y2                0.062    0.037    1.687    0.092    0.062    1.000
##    .y3                0.056    0.035    1.608    0.108    0.056    1.000
##    .y4                0.054    0.038    1.423    0.155    0.054    1.000</code></pre>
<!------------------------------>
</div>
<div id="part-ii-multilevel-cfa-2-between-only-construct" class="section level2 hasAnchor" number="22.2">
<h2><span class="header-section-number">22.2</span> PART II: Multilevel CFA 2: Between-only construct<a href="lavaan-lab-19-multilevel-sem.html#part-ii-multilevel-cfa-2-between-only-construct" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<ul>
<li>Example: construct reflects self-reported ‘school climate’ measured by a questionnaire filled in by the school principles</li>
<li>We will only have one response for each school</li>
<li>We may collect other variables from students/teachers in the schools though</li>
</ul>
<p>Note that the following model syntax:</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="lavaan-lab-19-multilevel-sem.html#cb867-1" aria-hidden="true" tabindex="-1"></a>model2.wrong <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb867-2"><a href="lavaan-lab-19-multilevel-sem.html#cb867-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb867-3"><a href="lavaan-lab-19-multilevel-sem.html#cb867-3" aria-hidden="true" tabindex="-1"></a><span class="st">  # perhaps other level-1 variables</span></span>
<span id="cb867-4"><a href="lavaan-lab-19-multilevel-sem.html#cb867-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-5"><a href="lavaan-lab-19-multilevel-sem.html#cb867-5" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb867-6"><a href="lavaan-lab-19-multilevel-sem.html#cb867-6" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ y1 + y2 + y3 + y4</span></span>
<span id="cb867-7"><a href="lavaan-lab-19-multilevel-sem.html#cb867-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb867-8"><a href="lavaan-lab-19-multilevel-sem.html#cb867-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-9"><a href="lavaan-lab-19-multilevel-sem.html#cb867-9" aria-hidden="true" tabindex="-1"></a>model2fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model2.wrong, <span class="at">data =</span> Data, </span>
<span id="cb867-10"><a href="lavaan-lab-19-multilevel-sem.html#cb867-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>,</span>
<span id="cb867-11"><a href="lavaan-lab-19-multilevel-sem.html#cb867-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb867-12"><a href="lavaan-lab-19-multilevel-sem.html#cb867-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="lavaan-lab-19-multilevel-sem.html#cb868-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">lav_partable_vnames</span>(tmp.lav, <span class="at">type =</span> <span class="st">&quot;ov&quot;</span>, <span class="at">level =</span> tmp.level.values[l]) <span class="sc">:</span> lavaan ERROR<span class="sc">:</span> level column does not contain value <span class="st">`</span><span class="at">1&#39;</span></span></code></pre></div>
<p>won’t work because there is nothing at level 1. Instead, specify this model just like a regular CFA model:</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="lavaan-lab-19-multilevel-sem.html#cb869-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb869-2"><a href="lavaan-lab-19-multilevel-sem.html#cb869-2" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ y1 + y2 + y3 + y4</span></span>
<span id="cb869-3"><a href="lavaan-lab-19-multilevel-sem.html#cb869-3" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Fit the model:</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="lavaan-lab-19-multilevel-sem.html#cb870-1" aria-hidden="true" tabindex="-1"></a>model2fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model2, <span class="at">data =</span> Data, </span>
<span id="cb870-2"><a href="lavaan-lab-19-multilevel-sem.html#cb870-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>,</span>
<span id="cb870-3"><a href="lavaan-lab-19-multilevel-sem.html#cb870-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb870-4"><a href="lavaan-lab-19-multilevel-sem.html#cb870-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span>
<span id="cb870-5"><a href="lavaan-lab-19-multilevel-sem.html#cb870-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-6"><a href="lavaan-lab-19-multilevel-sem.html#cb870-6" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model2fit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 20 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        12
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 0.108       0.107
##   Degrees of freedom                                 2           2
##   P-value (Chi-square)                           0.947       0.948
##   Scaling correction factor                                  1.013
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2729.902    5889.388
##   Degrees of freedom                                 6           6
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.464
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.002       1.001
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.002
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -6907.183   -6907.183
##   Scaling correction factor                                  1.205
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -6907.129   -6907.129
##   Scaling correction factor                                  1.178
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               13838.367   13838.367
##   Bayesian (BIC)                             13897.260   13897.260
##   Sample-size adjusted Bayesian (BIC)        13859.147   13859.147
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.007       0.003
##   P-value RMSEA &lt;= 0.05                          0.995       0.996
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.006
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.001       0.001
## 
## Parameter Estimates:
## 
##   Standard errors                        Robust.cluster
##   Information                                  Observed
##   Observed information based on                 Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1                1.000                               1.638    0.856
##     y2                0.995    0.031   31.694    0.000    1.629    0.860
##     y3                0.984    0.037   26.944    0.000    1.612    0.842
##     y4                1.003    0.029   34.582    0.000    1.643    0.851
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.064    0.090   -0.707    0.479   -0.064   -0.033
##    .y2               -0.058    0.089   -0.652    0.515   -0.058   -0.031
##    .y3               -0.026    0.087   -0.303    0.762   -0.026   -0.014
##    .y4               -0.011    0.091   -0.119    0.905   -0.011   -0.006
##     fb                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.983    0.065   15.151    0.000    0.983    0.268
##    .y2                0.937    0.060   15.657    0.000    0.937    0.261
##    .y3                1.065    0.058   18.477    0.000    1.065    0.291
##    .y4                1.030    0.064   16.008    0.000    1.030    0.276
##     fb                2.684    0.178   15.101    0.000    1.000    1.000</code></pre>
<!------------------------------>
</div>
<div id="part-iii-multilevel-cfa-3-shared-cross-level-construct" class="section level2 hasAnchor" number="22.3">
<h2><span class="header-section-number">22.3</span> PART III: Multilevel CFA 3: Shared cross-level construct<a href="lavaan-lab-19-multilevel-sem.html#part-iii-multilevel-cfa-3-shared-cross-level-construct" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<ul>
<li>This model specifies the latent variable both at the within and the between level;</li>
<li>However, the latent variable only makes sense at the between level so SEM model is only built at the between level;</li>
<li>The indicators are correlated at the within level;</li>
</ul>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="lavaan-lab-19-multilevel-sem.html#cb872-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb872-2"><a href="lavaan-lab-19-multilevel-sem.html#cb872-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb872-3"><a href="lavaan-lab-19-multilevel-sem.html#cb872-3" aria-hidden="true" tabindex="-1"></a><span class="st">    y1 ~~ y1 + y2 + y3 + y4</span></span>
<span id="cb872-4"><a href="lavaan-lab-19-multilevel-sem.html#cb872-4" aria-hidden="true" tabindex="-1"></a><span class="st">    y2 ~~ y2 + y3 + y4</span></span>
<span id="cb872-5"><a href="lavaan-lab-19-multilevel-sem.html#cb872-5" aria-hidden="true" tabindex="-1"></a><span class="st">    y3 ~~ y3 + y4</span></span>
<span id="cb872-6"><a href="lavaan-lab-19-multilevel-sem.html#cb872-6" aria-hidden="true" tabindex="-1"></a><span class="st">    y4 ~~ y4</span></span>
<span id="cb872-7"><a href="lavaan-lab-19-multilevel-sem.html#cb872-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-8"><a href="lavaan-lab-19-multilevel-sem.html#cb872-8" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb872-9"><a href="lavaan-lab-19-multilevel-sem.html#cb872-9" aria-hidden="true" tabindex="-1"></a><span class="st">    fs =~ y1 + y2 + y3 + y4</span></span>
<span id="cb872-10"><a href="lavaan-lab-19-multilevel-sem.html#cb872-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-11"><a href="lavaan-lab-19-multilevel-sem.html#cb872-11" aria-hidden="true" tabindex="-1"></a><span class="st"> # Fix Significant Heywood Cases</span></span>
<span id="cb872-12"><a href="lavaan-lab-19-multilevel-sem.html#cb872-12" aria-hidden="true" tabindex="-1"></a><span class="st">  y2 ~~ v2*y2</span></span>
<span id="cb872-13"><a href="lavaan-lab-19-multilevel-sem.html#cb872-13" aria-hidden="true" tabindex="-1"></a><span class="st">  y4 ~~ v4*y4</span></span>
<span id="cb872-14"><a href="lavaan-lab-19-multilevel-sem.html#cb872-14" aria-hidden="true" tabindex="-1"></a><span class="st">  v2 &gt; 0</span></span>
<span id="cb872-15"><a href="lavaan-lab-19-multilevel-sem.html#cb872-15" aria-hidden="true" tabindex="-1"></a><span class="st">  v4 &gt; 0 </span></span>
<span id="cb872-16"><a href="lavaan-lab-19-multilevel-sem.html#cb872-16" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Fit the model:</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="lavaan-lab-19-multilevel-sem.html#cb873-1" aria-hidden="true" tabindex="-1"></a>model3fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model3, <span class="at">data =</span> Data, </span>
<span id="cb873-2"><a href="lavaan-lab-19-multilevel-sem.html#cb873-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>,</span>
<span id="cb873-3"><a href="lavaan-lab-19-multilevel-sem.html#cb873-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb873-4"><a href="lavaan-lab-19-multilevel-sem.html#cb873-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="lavaan-lab-19-multilevel-sem.html#cb875-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model3fit, <span class="at">standardized =</span> T, <span class="at">fit.measures =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-11 ended normally after 94 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        21
##   Number of inequality constraints                   2
##                                                       
##   Number of observations                          1000
##   Number of clusters [clus]                        110
##                                                       
## Model Test User Model:
##                                                Standard      Robust
##   Test Statistic                                630.445     342.869
##   Degrees of freedom                                  3           3
##   P-value (Chi-square)                            0.000       0.000
##   Scaling correction factor                                   1.839
##        Yuan-Bentler correction (Mplus variant)                     
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2619.397    2815.244
##   Degrees of freedom                                12          12
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.930
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.759       0.879
##   Tucker-Lewis Index (TLI)                       0.037       0.515
##                                                                   
##   Robust Comparative Fit Index (CFI)                         0.760
##   Robust Tucker-Lewis Index (TLI)                            0.042
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -7189.561   -7189.561
##   Scaling correction factor                                  0.903
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -6874.338   -6874.338
##   Scaling correction factor                                  1.020
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               14421.121   14421.121
##   Bayesian (BIC)                             14524.184   14524.184
##   Sample-size adjusted Bayesian (BIC)        14457.487   14457.487
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.457       0.337
##   90 Percent confidence interval - lower         0.428       0.315
##   90 Percent confidence interval - upper         0.488       0.359
##   P-value RMSEA &lt;= 0.05                          0.000       0.000
##                                                                   
##   Robust RMSEA                                               0.456
##   90 Percent confidence interval - lower                     0.416
##   90 Percent confidence interval - upper                     0.498
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.266       0.266
##   SRMR (between covariance matrix)               0.010       0.010
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##  .y1 ~~                                                                 
##    .y2                1.289    0.106   12.112    0.000    1.289    0.480
##    .y3                1.417    0.076   18.696    0.000    1.417    0.580
##    .y4                1.209    0.106   11.409    0.000    1.209    0.440
##  .y2 ~~                                                                 
##    .y3                1.245    0.107   11.614    0.000    1.245    0.458
##  .y3 ~~                                                                 
##    .y4                1.228    0.108   11.332    0.000    1.228    0.442
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                2.417    0.095   25.385    0.000    2.417    1.000
##    .y2                2.983    0.137   21.836    0.000    2.983    1.000
##    .y3                2.474    0.098   25.227    0.000    2.474    1.000
##    .y4                3.121    0.143   21.864    0.000    3.121    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fs =~                                                                 
##     y1                1.000                               0.772    1.001
##     y2                1.044    0.079   13.219    0.000    0.807    1.000
##     y3                0.963    0.066   14.530    0.000    0.744    1.008
##     y4                1.044    0.083   12.581    0.000    0.807    1.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.076    0.090   -0.853    0.394   -0.076   -0.099
##    .y2               -0.071    0.095   -0.747    0.455   -0.071   -0.088
##    .y3               -0.039    0.087   -0.445    0.656   -0.039   -0.053
##    .y4               -0.024    0.096   -0.248    0.804   -0.024   -0.030
##     fs                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y2        (v2)   -0.000       NA                     -0.000   -0.000
##    .y4        (v4)   -0.000                              -0.000   -0.000
##    .y1               -0.002    0.020   -0.077    0.939   -0.002   -0.003
##    .y3               -0.009    0.019   -0.455    0.649   -0.009   -0.016
##     fs                0.597    0.120    4.960    0.000    1.000    1.000
## 
## Constraints:
##                                                |Slack|
##     v2 - 0                                       0.000
##     v4 - 0                                       0.000</code></pre>
<!------------------------------>
</div>
<div id="part-iv-multilevel-cfa-4-configural-construct" class="section level2 hasAnchor" number="22.4">
<h2><span class="header-section-number">22.4</span> PART IV: Multilevel CFA 4: Configural construct<a href="lavaan-lab-19-multilevel-sem.html#part-iv-multilevel-cfa-4-configural-construct" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<ul>
<li>Model 4a specifies the latent variable both at the within and the between level;</li>
<li>The CFA at each level should have the same factor structure, but not necessarily the same parameter estimates;</li>
</ul>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="lavaan-lab-19-multilevel-sem.html#cb877-1" aria-hidden="true" tabindex="-1"></a>model4a <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb877-2"><a href="lavaan-lab-19-multilevel-sem.html#cb877-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb877-3"><a href="lavaan-lab-19-multilevel-sem.html#cb877-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ y1 + y2 + y3 + y4</span></span>
<span id="cb877-4"><a href="lavaan-lab-19-multilevel-sem.html#cb877-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb877-5"><a href="lavaan-lab-19-multilevel-sem.html#cb877-5" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb877-6"><a href="lavaan-lab-19-multilevel-sem.html#cb877-6" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ y1 + y2 + y3 + y4</span></span>
<span id="cb877-7"><a href="lavaan-lab-19-multilevel-sem.html#cb877-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb877-8"><a href="lavaan-lab-19-multilevel-sem.html#cb877-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb877-9"><a href="lavaan-lab-19-multilevel-sem.html#cb877-9" aria-hidden="true" tabindex="-1"></a>model4afit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model4a, <span class="at">data =</span> Data, </span>
<span id="cb877-10"><a href="lavaan-lab-19-multilevel-sem.html#cb877-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>,</span>
<span id="cb877-11"><a href="lavaan-lab-19-multilevel-sem.html#cb877-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb877-12"><a href="lavaan-lab-19-multilevel-sem.html#cb877-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="lavaan-lab-19-multilevel-sem.html#cb879-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model4afit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 50 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        20
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 0.000       0.000
##   Degrees of freedom                                 4           4
##   P-value (Chi-square)                           1.000       1.000
##   Scaling correction factor                                  0.977
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2619.397    2815.244
##   Degrees of freedom                                12          12
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.930
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.005       1.004
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.004
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -6874.157   -6874.157
##   Scaling correction factor                                  1.028
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -6874.338   -6874.338
##   Scaling correction factor                                  1.020
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               13788.314   13788.314
##   Bayesian (BIC)                             13886.469   13886.469
##   Sample-size adjusted Bayesian (BIC)        13822.948   13822.948
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.000       0.000
##   P-value RMSEA &lt;= 0.05                          1.000       1.000
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.000
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.001       0.001
##   SRMR (between covariance matrix)               0.003       0.003
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1                1.000                               1.486    0.831
##     y2                0.992    0.035   28.208    0.000    1.474    0.836
##     y3                0.992    0.041   24.110    0.000    1.474    0.818
##     y4                1.007    0.035   28.619    0.000    1.496    0.830
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.989    0.071   13.980    0.000    0.989    0.309
##    .y2                0.934    0.062   15.187    0.000    0.934    0.301
##    .y3                1.076    0.057   18.812    0.000    1.076    0.331
##    .y4                1.014    0.070   14.478    0.000    1.014    0.312
##     fw                2.207    0.165   13.371    0.000    1.000    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1                1.000                               0.700    1.006
##     y2                1.005    0.086   11.732    0.000    0.704    0.998
##     y3                0.947    0.094   10.117    0.000    0.663    1.013
##     y4                0.984    0.080   12.240    0.000    0.689    0.983
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.072    0.089   -0.815    0.415   -0.072   -0.104
##    .y2               -0.067    0.088   -0.755    0.450   -0.067   -0.095
##    .y3               -0.035    0.086   -0.404    0.687   -0.035   -0.053
##    .y4               -0.018    0.089   -0.205    0.838   -0.018   -0.026
##     fb                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.006    0.018   -0.339    0.734   -0.006   -0.012
##    .y2                0.002    0.020    0.091    0.928    0.002    0.004
##    .y3               -0.011    0.020   -0.541    0.589   -0.011   -0.025
##    .y4                0.016    0.021    0.786    0.432    0.016    0.033
##     fb                0.490    0.120    4.099    0.000    1.000    1.000</code></pre>
<ul>
<li>Model 4b specifies the same CFA at each level and requires the same factor loadings;</li>
</ul>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="lavaan-lab-19-multilevel-sem.html#cb881-1" aria-hidden="true" tabindex="-1"></a>model4b <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb881-2"><a href="lavaan-lab-19-multilevel-sem.html#cb881-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb881-3"><a href="lavaan-lab-19-multilevel-sem.html#cb881-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb881-4"><a href="lavaan-lab-19-multilevel-sem.html#cb881-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb881-5"><a href="lavaan-lab-19-multilevel-sem.html#cb881-5" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb881-6"><a href="lavaan-lab-19-multilevel-sem.html#cb881-6" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb881-7"><a href="lavaan-lab-19-multilevel-sem.html#cb881-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb881-8"><a href="lavaan-lab-19-multilevel-sem.html#cb881-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb881-9"><a href="lavaan-lab-19-multilevel-sem.html#cb881-9" aria-hidden="true" tabindex="-1"></a>model4bfit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model4b, <span class="at">data =</span> Data, </span>
<span id="cb881-10"><a href="lavaan-lab-19-multilevel-sem.html#cb881-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>,</span>
<span id="cb881-11"><a href="lavaan-lab-19-multilevel-sem.html#cb881-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb881-12"><a href="lavaan-lab-19-multilevel-sem.html#cb881-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="lavaan-lab-19-multilevel-sem.html#cb883-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model4bfit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 44 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        20
##   Number of equality constraints                     3
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 0.057       0.059
##   Degrees of freedom                                 7           7
##   P-value (Chi-square)                           1.000       1.000
##   Scaling correction factor                                  0.967
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2619.397    2815.244
##   Degrees of freedom                                12          12
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.930
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.005       1.004
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.004
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -6874.367   -6874.367
##   Scaling correction factor                                  0.885
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -6874.338   -6874.338
##   Scaling correction factor                                  1.020
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               13782.733   13782.733
##   Bayesian (BIC)                             13866.165   13866.165
##   Sample-size adjusted Bayesian (BIC)        13812.172   13812.172
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.000       0.000
##   P-value RMSEA &lt;= 0.05                          1.000       1.000
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.000
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.002       0.002
##   SRMR (between covariance matrix)               0.003       0.003
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1         (a)    1.000                               1.489    0.832
##     y2         (b)    0.995    0.031   31.649    0.000    1.482    0.838
##     y3         (c)    0.983    0.036   27.090    0.000    1.463    0.815
##     y4         (d)    1.003    0.029   34.668    0.000    1.494    0.829
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.987    0.069   14.228    0.000    0.987    0.308
##    .y2                0.930    0.061   15.173    0.000    0.930    0.298
##    .y3                1.081    0.057   18.905    0.000    1.081    0.335
##    .y4                1.015    0.068   14.877    0.000    1.015    0.313
##     fw                2.218    0.158   14.021    0.000    1.000    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1         (a)    1.000                               0.693    1.005
##     y2         (b)    0.995    0.031   31.649    0.000    0.690    0.997
##     y3         (c)    0.983    0.036   27.090    0.000    0.681    1.013
##     y4         (d)    1.003    0.029   34.668    0.000    0.695    0.984
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.071    0.089   -0.804    0.421   -0.071   -0.103
##    .y2               -0.066    0.088   -0.746    0.456   -0.066   -0.095
##    .y3               -0.034    0.086   -0.396    0.692   -0.034   -0.051
##    .y4               -0.017    0.089   -0.196    0.845   -0.017   -0.025
##     fb                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.005    0.016   -0.302    0.763   -0.005   -0.010
##    .y2                0.003    0.019    0.170    0.865    0.003    0.007
##    .y3               -0.012    0.020   -0.601    0.548   -0.012   -0.027
##    .y4                0.016    0.020    0.767    0.443    0.016    0.031
##     fb                0.480    0.119    4.027    0.000    1.000    1.000</code></pre>
<!------------------------------>
</div>
<div id="part-v-multilevel-cfa-5-shared-configural-construct" class="section level2 hasAnchor" number="22.5">
<h2><span class="header-section-number">22.5</span> PART V: Multilevel CFA 5: Shared + Configural construct<a href="lavaan-lab-19-multilevel-sem.html#part-v-multilevel-cfa-5-shared-configural-construct" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<ul>
<li>This model specifies the latent variable both at the within and the between level;</li>
<li>The CFA at each level should have the same factor structure, but not necessarily the same parameter estimates;</li>
</ul>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="lavaan-lab-19-multilevel-sem.html#cb885-1" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb885-2"><a href="lavaan-lab-19-multilevel-sem.html#cb885-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb885-3"><a href="lavaan-lab-19-multilevel-sem.html#cb885-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb885-4"><a href="lavaan-lab-19-multilevel-sem.html#cb885-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb885-5"><a href="lavaan-lab-19-multilevel-sem.html#cb885-5" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb885-6"><a href="lavaan-lab-19-multilevel-sem.html#cb885-6" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ a*y1 + b*y2 + c*y3 + d*y4   # configural</span></span>
<span id="cb885-7"><a href="lavaan-lab-19-multilevel-sem.html#cb885-7" aria-hidden="true" tabindex="-1"></a><span class="st">    fs =~ y1 + y2 + y3 + y4           # shared</span></span>
<span id="cb885-8"><a href="lavaan-lab-19-multilevel-sem.html#cb885-8" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb885-9"><a href="lavaan-lab-19-multilevel-sem.html#cb885-9" aria-hidden="true" tabindex="-1"></a><span class="st">    # fb and fs must be orthogonal</span></span>
<span id="cb885-10"><a href="lavaan-lab-19-multilevel-sem.html#cb885-10" aria-hidden="true" tabindex="-1"></a><span class="st">    fs ~~ 0*fb</span></span>
<span id="cb885-11"><a href="lavaan-lab-19-multilevel-sem.html#cb885-11" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb885-12"><a href="lavaan-lab-19-multilevel-sem.html#cb885-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb885-13"><a href="lavaan-lab-19-multilevel-sem.html#cb885-13" aria-hidden="true" tabindex="-1"></a>model5fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model5, <span class="at">data =</span> Data, </span>
<span id="cb885-14"><a href="lavaan-lab-19-multilevel-sem.html#cb885-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>,</span>
<span id="cb885-15"><a href="lavaan-lab-19-multilevel-sem.html#cb885-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb885-16"><a href="lavaan-lab-19-multilevel-sem.html#cb885-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="lavaan-lab-19-multilevel-sem.html#cb887-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model5fit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 56 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        24
##   Number of equality constraints                     3
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 0.000       0.000
##   Degrees of freedom                                 3           3
##   P-value (Chi-square)                           1.000       1.000
##   Scaling correction factor                                  0.920
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2619.397    2815.244
##   Degrees of freedom                                12          12
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.930
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.005       1.004
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.004
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -6874.156   -6874.156
##   Scaling correction factor                                  0.905
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -6874.338   -6874.338
##   Scaling correction factor                                  1.020
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               13790.312   13790.312
##   Bayesian (BIC)                             13893.375   13893.375
##   Sample-size adjusted Bayesian (BIC)        13826.678   13826.678
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.000       0.000
##   P-value RMSEA &lt;= 0.05                          1.000       1.000
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.000
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.001       0.001
##   SRMR (between covariance matrix)               0.003       0.003
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1         (a)    1.000                               1.486    0.831
##     y2         (b)    0.993    0.036   27.488    0.000    1.474    0.836
##     y3         (c)    0.992    0.042   23.900    0.000    1.473    0.818
##     y4         (d)    1.007    0.036   28.299    0.000    1.496    0.830
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.989    0.071   13.979    0.000    0.989    0.309
##    .y2                0.934    0.061   15.212    0.000    0.934    0.301
##    .y3                1.076    0.057   18.809    0.000    1.076    0.331
##    .y4                1.014    0.070   14.414    0.000    1.014    0.312
##     fw                2.207    0.167   13.244    0.000    1.000    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1         (a)    1.000                               0.492    0.706
##     y2         (b)    0.993    0.036   27.488    0.000    0.488    0.692
##     y3         (c)    0.992    0.042   23.900    0.000    0.488    0.745
##     y4         (d)    1.007    0.036   28.299    0.000    0.495    0.707
##   fs =~                                                                 
##     y1                1.000                               0.499    0.717
##     y2                1.018    0.288    3.533    0.000    0.508    0.720
##     y3                0.903    1.179    0.766    0.444    0.450    0.688
##     y4                0.960    0.690    1.391    0.164    0.479    0.684
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb ~~                                                                 
##     fs                0.000                               0.000    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.073    0.089   -0.819    0.413   -0.073   -0.104
##    .y2               -0.067    0.088   -0.758    0.449   -0.067   -0.095
##    .y3               -0.035    0.086   -0.406    0.685   -0.035   -0.053
##    .y4               -0.018    0.089   -0.207    0.836   -0.018   -0.026
##     fb                0.000                               0.000    0.000
##     fs                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.006    0.018   -0.330    0.742   -0.006   -0.012
##    .y2                0.001    0.021    0.063    0.950    0.001    0.003
##    .y3               -0.012    0.027   -0.427    0.670   -0.012   -0.027
##    .y4                0.016    0.021    0.779    0.436    0.016    0.033
##     fb                0.242    3.053    0.079    0.937    1.000    1.000
##     fs                0.249    3.022    0.082    0.934    1.000    1.000</code></pre>
<!------------------------------>
</div>
<div id="part-vi-model-comparison" class="section level2 hasAnchor" number="22.6">
<h2><span class="header-section-number">22.6</span> PART VI: Model Comparison<a href="lavaan-lab-19-multilevel-sem.html#part-vi-model-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="lavaan-lab-19-multilevel-sem.html#cb889-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">fitMeasures</span>(model1fit, <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">&quot;chisq.scaled&quot;</span>, <span class="st">&quot;df.scaled&quot;</span>, <span class="st">&quot;pvalue.scaled&quot;</span>, <span class="st">&quot;rmsea.robust&quot;</span>, <span class="st">&quot;rmsea.ci.lower.robust&quot;</span>, <span class="st">&quot;rmsea.ci.upper.robust&quot;</span>, <span class="st">&quot;cfi.robust&quot;</span>, <span class="st">&quot;tli.robust&quot;</span>, <span class="st">&quot;srmr_within&quot;</span>, <span class="st">&quot;srmr_between&quot;</span>))</span>
<span id="cb889-2"><a href="lavaan-lab-19-multilevel-sem.html#cb889-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">fitMeasures</span>(model2fit, <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">&quot;chisq.scaled&quot;</span>, <span class="st">&quot;df.scaled&quot;</span>, <span class="st">&quot;pvalue.scaled&quot;</span>, <span class="st">&quot;rmsea.robust&quot;</span>, <span class="st">&quot;rmsea.ci.lower.robust&quot;</span>, <span class="st">&quot;rmsea.ci.upper.robust&quot;</span>, <span class="st">&quot;cfi.robust&quot;</span>, <span class="st">&quot;tli.robust&quot;</span>, <span class="st">&quot;srmr_within&quot;</span>, <span class="st">&quot;srmr_between&quot;</span>))</span>
<span id="cb889-3"><a href="lavaan-lab-19-multilevel-sem.html#cb889-3" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">=</span> <span class="fu">fitMeasures</span>(model3fit, <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">&quot;chisq.scaled&quot;</span>, <span class="st">&quot;df.scaled&quot;</span>, <span class="st">&quot;pvalue.scaled&quot;</span>, <span class="st">&quot;rmsea.robust&quot;</span>, <span class="st">&quot;rmsea.ci.lower.robust&quot;</span>, <span class="st">&quot;rmsea.ci.upper.robust&quot;</span>, <span class="st">&quot;cfi.robust&quot;</span>, <span class="st">&quot;tli.robust&quot;</span>, <span class="st">&quot;srmr_within&quot;</span>, <span class="st">&quot;srmr_between&quot;</span>))</span>
<span id="cb889-4"><a href="lavaan-lab-19-multilevel-sem.html#cb889-4" aria-hidden="true" tabindex="-1"></a>m4a <span class="ot">=</span> <span class="fu">fitMeasures</span>(model4afit, <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">&quot;chisq.scaled&quot;</span>, <span class="st">&quot;df.scaled&quot;</span>, <span class="st">&quot;pvalue.scaled&quot;</span>, <span class="st">&quot;rmsea.robust&quot;</span>, <span class="st">&quot;rmsea.ci.lower.robust&quot;</span>, <span class="st">&quot;rmsea.ci.upper.robust&quot;</span>, <span class="st">&quot;cfi.robust&quot;</span>, <span class="st">&quot;tli.robust&quot;</span>, <span class="st">&quot;srmr_within&quot;</span>, <span class="st">&quot;srmr_between&quot;</span>))</span>
<span id="cb889-5"><a href="lavaan-lab-19-multilevel-sem.html#cb889-5" aria-hidden="true" tabindex="-1"></a>m4b <span class="ot">=</span> <span class="fu">fitMeasures</span>(model4bfit, <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">&quot;chisq.scaled&quot;</span>, <span class="st">&quot;df.scaled&quot;</span>, <span class="st">&quot;pvalue.scaled&quot;</span>, <span class="st">&quot;rmsea.robust&quot;</span>, <span class="st">&quot;rmsea.ci.lower.robust&quot;</span>, <span class="st">&quot;rmsea.ci.upper.robust&quot;</span>, <span class="st">&quot;cfi.robust&quot;</span>, <span class="st">&quot;tli.robust&quot;</span>, <span class="st">&quot;srmr_within&quot;</span>, <span class="st">&quot;srmr_between&quot;</span>))</span>
<span id="cb889-6"><a href="lavaan-lab-19-multilevel-sem.html#cb889-6" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">=</span> <span class="fu">fitMeasures</span>(model5fit, <span class="at">fit.measures =</span> <span class="fu">c</span>(<span class="st">&quot;chisq.scaled&quot;</span>, <span class="st">&quot;df.scaled&quot;</span>, <span class="st">&quot;pvalue.scaled&quot;</span>, <span class="st">&quot;rmsea.robust&quot;</span>, <span class="st">&quot;rmsea.ci.lower.robust&quot;</span>, <span class="st">&quot;rmsea.ci.upper.robust&quot;</span>, <span class="st">&quot;cfi.robust&quot;</span>, <span class="st">&quot;tli.robust&quot;</span>, <span class="st">&quot;srmr_within&quot;</span>, <span class="st">&quot;srmr_between&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="lavaan-lab-19-multilevel-sem.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;qpcR&#39;)</span></span>
<span id="cb890-2"><a href="lavaan-lab-19-multilevel-sem.html#cb890-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qpcR)</span>
<span id="cb890-3"><a href="lavaan-lab-19-multilevel-sem.html#cb890-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(qpcR<span class="sc">:::</span><span class="fu">cbind.na</span>(m1, m2, m3, m4a, m4b, m5), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                           m1    m2      m3   m4a   m4b    m5
## chisq.scaled          64.738 0.107 342.869 0.000 0.059 0.000
## df.scaled              3.000 2.000   3.000 4.000 7.000 3.000
## pvalue.scaled          0.000 0.948   0.000 1.000 1.000 1.000
## rmsea.robust           0.129 0.000   0.456 0.000 0.000 0.000
## rmsea.ci.lower.robust  0.103 0.000   0.416 0.000 0.000 0.000
## rmsea.ci.upper.robust  0.157 0.006   0.498 0.000 0.000 0.000
## cfi.robust             0.981 1.000   0.760 1.000 1.000 1.000
## tli.robust             0.923 1.002   0.042 1.004 1.004 1.004
## srmr_within            0.022    NA   0.266 0.001 0.002 0.001
## srmr_between           0.334    NA   0.010 0.003 0.003 0.003</code></pre>
<p>The final model goes to (drumroll)…model4b!</p>
<!------------------------------>
</div>
<div id="part-vii-adding-covariates-to-multilevel-sem" class="section level2 hasAnchor" number="22.7">
<h2><span class="header-section-number">22.7</span> PART VII: Adding Covariates to Multilevel SEM<a href="lavaan-lab-19-multilevel-sem.html#part-vii-adding-covariates-to-multilevel-sem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<div id="model-a-adding-a-within-only-covariate" class="section level3 hasAnchor" number="22.7.1">
<h3><span class="header-section-number">22.7.1</span> Model A: Adding a within-only covariate<a href="lavaan-lab-19-multilevel-sem.html#model-a-adding-a-within-only-covariate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="lavaan-lab-19-multilevel-sem.html#cb892-1" aria-hidden="true" tabindex="-1"></a>model4wCovA <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb892-2"><a href="lavaan-lab-19-multilevel-sem.html#cb892-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb892-3"><a href="lavaan-lab-19-multilevel-sem.html#cb892-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb892-4"><a href="lavaan-lab-19-multilevel-sem.html#cb892-4" aria-hidden="true" tabindex="-1"></a><span class="st">    fw ~ x1</span></span>
<span id="cb892-5"><a href="lavaan-lab-19-multilevel-sem.html#cb892-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-6"><a href="lavaan-lab-19-multilevel-sem.html#cb892-6" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb892-7"><a href="lavaan-lab-19-multilevel-sem.html#cb892-7" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb892-8"><a href="lavaan-lab-19-multilevel-sem.html#cb892-8" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb892-9"><a href="lavaan-lab-19-multilevel-sem.html#cb892-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-10"><a href="lavaan-lab-19-multilevel-sem.html#cb892-10" aria-hidden="true" tabindex="-1"></a>model4wCovAfit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model4wCovA, <span class="at">data =</span> Data, </span>
<span id="cb892-11"><a href="lavaan-lab-19-multilevel-sem.html#cb892-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>, </span>
<span id="cb892-12"><a href="lavaan-lab-19-multilevel-sem.html#cb892-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb892-13"><a href="lavaan-lab-19-multilevel-sem.html#cb892-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="lavaan-lab-19-multilevel-sem.html#cb894-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model4wCovAfit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 54 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        23
##   Number of equality constraints                     3
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 1.793       1.874
##   Degrees of freedom                                10          10
##   P-value (Chi-square)                           0.998       0.997
##   Scaling correction factor                                  0.957
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              3085.335    3318.855
##   Degrees of freedom                                16          16
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.930
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.004       1.004
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.004
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -8053.772   -8053.772
##   Scaling correction factor                                  0.901
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -8052.875   -8052.875
##   Scaling correction factor                                  1.009
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               16147.544   16147.544
##   Bayesian (BIC)                             16245.699   16245.699
##   Sample-size adjusted Bayesian (BIC)        16182.178   16182.178
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.000       0.000
##   P-value RMSEA &lt;= 0.05                          1.000       1.000
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.000
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.004       0.004
##   SRMR (between covariance matrix)               0.004       0.004
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1         (a)    1.000                               1.501    0.834
##     y2         (b)    0.994    0.031   32.270    0.000    1.491    0.838
##     y3         (c)    0.984    0.036   27.550    0.000    1.476    0.818
##     y4         (d)    1.006    0.029   34.896    0.000    1.510    0.834
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw ~                                                                  
##     x1                1.002    0.050   20.044    0.000    0.667    0.663
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     x1                0.007    0.036    0.195    0.846    0.007    0.007
##    .fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.989    0.065   15.126    0.000    0.989    0.305
##    .y2                0.942    0.055   17.114    0.000    0.942    0.297
##    .y3                1.080    0.058   18.491    0.000    1.080    0.331
##    .y4                1.001    0.065   15.438    0.000    1.001    0.305
##    .fw                1.264    0.096   13.119    0.000    0.561    0.561
##     x1                0.985    0.042   23.406    0.000    0.985    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1         (a)    1.000                               0.636    1.004
##     y2         (b)    0.994    0.031   32.270    0.000    0.632    0.998
##     y3         (c)    0.984    0.036   27.550    0.000    0.626    1.016
##     y4         (d)    1.006    0.029   34.896    0.000    0.640    0.982
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.070    0.080   -0.873    0.383   -0.070   -0.110
##    .y2               -0.064    0.078   -0.823    0.410   -0.064   -0.101
##    .y3               -0.033    0.076   -0.430    0.667   -0.033   -0.053
##    .y4               -0.016    0.078   -0.203    0.839   -0.016   -0.024
##     fb                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.003    0.017   -0.177    0.860   -0.003   -0.007
##    .y2                0.002    0.019    0.094    0.925    0.002    0.005
##    .y3               -0.012    0.020   -0.624    0.533   -0.012   -0.033
##    .y4                0.015    0.020    0.766    0.444    0.015    0.036
##     fb                0.405    0.085    4.751    0.000    1.000    1.000</code></pre>
</div>
<div id="model-b-adding-a-between-only-covariate" class="section level3 hasAnchor" number="22.7.2">
<h3><span class="header-section-number">22.7.2</span> Model B: Adding a between-only covariate<a href="lavaan-lab-19-multilevel-sem.html#model-b-adding-a-between-only-covariate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="lavaan-lab-19-multilevel-sem.html#cb896-1" aria-hidden="true" tabindex="-1"></a>model4wCovB <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb896-2"><a href="lavaan-lab-19-multilevel-sem.html#cb896-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb896-3"><a href="lavaan-lab-19-multilevel-sem.html#cb896-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb896-4"><a href="lavaan-lab-19-multilevel-sem.html#cb896-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb896-5"><a href="lavaan-lab-19-multilevel-sem.html#cb896-5" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb896-6"><a href="lavaan-lab-19-multilevel-sem.html#cb896-6" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb896-7"><a href="lavaan-lab-19-multilevel-sem.html#cb896-7" aria-hidden="true" tabindex="-1"></a><span class="st">    fb ~ w</span></span>
<span id="cb896-8"><a href="lavaan-lab-19-multilevel-sem.html#cb896-8" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb896-9"><a href="lavaan-lab-19-multilevel-sem.html#cb896-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb896-10"><a href="lavaan-lab-19-multilevel-sem.html#cb896-10" aria-hidden="true" tabindex="-1"></a>model4wCovBfit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model4wCovB, <span class="at">data =</span> Data, </span>
<span id="cb896-11"><a href="lavaan-lab-19-multilevel-sem.html#cb896-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>, </span>
<span id="cb896-12"><a href="lavaan-lab-19-multilevel-sem.html#cb896-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb896-13"><a href="lavaan-lab-19-multilevel-sem.html#cb896-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="lavaan-lab-19-multilevel-sem.html#cb898-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model4wCovBfit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 35 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        23
##   Number of equality constraints                     3
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 2.509       2.568
##   Degrees of freedom                                10          10
##   P-value (Chi-square)                           0.991       0.990
##   Scaling correction factor                                  0.977
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2638.435    2788.623
##   Degrees of freedom                                16          16
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.946
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.005       1.004
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.004
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -7010.919   -7010.919
##   Scaling correction factor                                  0.897
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -7009.664   -7009.664
##   Scaling correction factor                                  1.013
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               14061.838   14061.838
##   Bayesian (BIC)                             14159.993   14159.993
##   Sample-size adjusted Bayesian (BIC)        14096.472   14096.472
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.000       0.000
##   P-value RMSEA &lt;= 0.05                          1.000       1.000
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.000
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.002       0.002
##   SRMR (between covariance matrix)               0.017       0.017
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1         (a)    1.000                               1.491    0.832
##     y2         (b)    0.994    0.031   31.642    0.000    1.482    0.838
##     y3         (c)    0.982    0.036   27.079    0.000    1.464    0.815
##     y4         (d)    1.002    0.029   34.699    0.000    1.494    0.829
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.987    0.069   14.241    0.000    0.987    0.308
##    .y2                0.929    0.061   15.165    0.000    0.929    0.297
##    .y3                1.081    0.057   18.940    0.000    1.081    0.335
##    .y4                1.015    0.068   14.894    0.000    1.015    0.313
##     fw                2.223    0.159   14.004    0.000    1.000    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1         (a)    1.000                               0.687    1.007
##     y2         (b)    0.994    0.031   31.642    0.000    0.683    0.994
##     y3         (c)    0.982    0.036   27.079    0.000    0.675    1.015
##     y4         (d)    1.002    0.029   34.699    0.000    0.688    0.983
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb ~                                                                  
##     w                 0.363    0.103    3.533    0.000    0.529    0.477
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.073    0.081   -0.900    0.368   -0.073   -0.107
##    .y2               -0.068    0.084   -0.813    0.416   -0.068   -0.099
##    .y3               -0.036    0.079   -0.451    0.652   -0.036   -0.054
##    .y4               -0.019    0.083   -0.229    0.819   -0.019   -0.027
##     w                 0.006    0.086    0.070    0.944    0.006    0.007
##    .fb                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.007    0.016   -0.415    0.678   -0.007   -0.015
##    .y2                0.006    0.019    0.290    0.772    0.006    0.012
##    .y3               -0.013    0.020   -0.639    0.523   -0.013   -0.029
##    .y4                0.016    0.021    0.778    0.437    0.016    0.033
##    .fb                0.364    0.078    4.645    0.000    0.772    0.772
##     w                 0.815    0.107    7.638    0.000    0.815    1.000</code></pre>
</div>
<div id="model-c-adding-a-covariate-at-both-levels" class="section level3 hasAnchor" number="22.7.3">
<h3><span class="header-section-number">22.7.3</span> Model C: Adding a covariate at both levels<a href="lavaan-lab-19-multilevel-sem.html#model-c-adding-a-covariate-at-both-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="lavaan-lab-19-multilevel-sem.html#cb900-1" aria-hidden="true" tabindex="-1"></a>model4wCovC <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb900-2"><a href="lavaan-lab-19-multilevel-sem.html#cb900-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb900-3"><a href="lavaan-lab-19-multilevel-sem.html#cb900-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb900-4"><a href="lavaan-lab-19-multilevel-sem.html#cb900-4" aria-hidden="true" tabindex="-1"></a><span class="st">    fw ~ x1</span></span>
<span id="cb900-5"><a href="lavaan-lab-19-multilevel-sem.html#cb900-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb900-6"><a href="lavaan-lab-19-multilevel-sem.html#cb900-6" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb900-7"><a href="lavaan-lab-19-multilevel-sem.html#cb900-7" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb900-8"><a href="lavaan-lab-19-multilevel-sem.html#cb900-8" aria-hidden="true" tabindex="-1"></a><span class="st">    fb ~ x1</span></span>
<span id="cb900-9"><a href="lavaan-lab-19-multilevel-sem.html#cb900-9" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb900-10"><a href="lavaan-lab-19-multilevel-sem.html#cb900-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb900-11"><a href="lavaan-lab-19-multilevel-sem.html#cb900-11" aria-hidden="true" tabindex="-1"></a>model4wCovCfit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(model4wCovC, <span class="at">data =</span> Data, </span>
<span id="cb900-12"><a href="lavaan-lab-19-multilevel-sem.html#cb900-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>, </span>
<span id="cb900-13"><a href="lavaan-lab-19-multilevel-sem.html#cb900-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb900-14"><a href="lavaan-lab-19-multilevel-sem.html#cb900-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="lavaan-lab-19-multilevel-sem.html#cb902-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(model4wCovCfit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 83 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        25
##   Number of equality constraints                     3
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 2.676       2.757
##   Degrees of freedom                                13          13
##   P-value (Chi-square)                           0.999       0.999
##   Scaling correction factor                                  0.971
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              3086.903    3246.984
##   Degrees of freedom                                20          20
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.951
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.005       1.005
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.005
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -8052.605   -8052.605
##   Scaling correction factor                                  0.898
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -8051.267   -8051.267
##   Scaling correction factor                                  1.002
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               16149.210   16149.210
##   Bayesian (BIC)                             16257.180   16257.180
##   Sample-size adjusted Bayesian (BIC)        16187.307   16187.307
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.000       0.000
##   P-value RMSEA &lt;= 0.05                          1.000       1.000
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.000
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.004       0.004
##   SRMR (between covariance matrix)               0.023       0.023
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1         (a)    1.000                               1.489    0.832
##     y2         (b)    0.994    0.031   32.214    0.000    1.480    0.836
##     y3         (c)    0.984    0.036   27.538    0.000    1.465    0.816
##     y4         (d)    1.006    0.029   34.847    0.000    1.499    0.832
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw ~                                                                  
##     x1                0.995    0.052   18.985    0.000    0.668    0.656
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     x1                0.000                               0.000    0.000
##    .fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.989    0.065   15.129    0.000    0.989    0.308
##    .y2                0.942    0.055   17.105    0.000    0.942    0.301
##    .y3                1.080    0.058   18.488    0.000    1.080    0.335
##    .y4                1.001    0.065   15.435    0.000    1.001    0.308
##    .fw                1.263    0.097   13.085    0.000    0.570    0.570
##     x1                0.965    0.044   21.724    0.000    0.965    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1         (a)    1.000                               0.686    1.003
##     y2         (b)    0.994    0.031   32.214    0.000    0.682    0.998
##     y3         (c)    0.984    0.036   27.538    0.000    0.675    1.014
##     y4         (d)    1.006    0.029   34.847    0.000    0.690    0.984
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb ~                                                                  
##     x1                2.069    1.515    1.366    0.172    3.017    0.432
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.076    0.087   -0.865    0.387   -0.076   -0.110
##    .y2               -0.070    0.084   -0.839    0.402   -0.070   -0.103
##    .y3               -0.038    0.082   -0.470    0.638   -0.038   -0.058
##    .y4               -0.022    0.084   -0.259    0.795   -0.022   -0.031
##     x1                0.005    0.034    0.141    0.888    0.005    0.034
##    .fb                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.003    0.017   -0.158    0.875   -0.003   -0.006
##    .y2                0.002    0.019    0.089    0.929    0.002    0.004
##    .y3               -0.012    0.020   -0.624    0.533   -0.012   -0.028
##    .y4                0.015    0.020    0.756    0.450    0.015    0.031
##    .fb                0.383    0.101    3.800    0.000    0.813    0.813
##     x1                0.021    0.016    1.267    0.205    0.021    1.000</code></pre>
<!------------------------------>
</div>
</div>
<div id="part-vii-final-model" class="section level2 hasAnchor" number="22.8">
<h2><span class="header-section-number">22.8</span> PART VII: Final Model<a href="lavaan-lab-19-multilevel-sem.html#part-vii-final-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!------------------------------>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="lavaan-lab-19-multilevel-sem.html#cb904-1" aria-hidden="true" tabindex="-1"></a>modelFinal <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb904-2"><a href="lavaan-lab-19-multilevel-sem.html#cb904-2" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 1</span></span>
<span id="cb904-3"><a href="lavaan-lab-19-multilevel-sem.html#cb904-3" aria-hidden="true" tabindex="-1"></a><span class="st">    fw =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb904-4"><a href="lavaan-lab-19-multilevel-sem.html#cb904-4" aria-hidden="true" tabindex="-1"></a><span class="st">    fw ~ x1 + x2</span></span>
<span id="cb904-5"><a href="lavaan-lab-19-multilevel-sem.html#cb904-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb904-6"><a href="lavaan-lab-19-multilevel-sem.html#cb904-6" aria-hidden="true" tabindex="-1"></a><span class="st">  level: 2</span></span>
<span id="cb904-7"><a href="lavaan-lab-19-multilevel-sem.html#cb904-7" aria-hidden="true" tabindex="-1"></a><span class="st">    fb =~ a*y1 + b*y2 + c*y3 + d*y4</span></span>
<span id="cb904-8"><a href="lavaan-lab-19-multilevel-sem.html#cb904-8" aria-hidden="true" tabindex="-1"></a><span class="st">    fb ~ w</span></span>
<span id="cb904-9"><a href="lavaan-lab-19-multilevel-sem.html#cb904-9" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb904-10"><a href="lavaan-lab-19-multilevel-sem.html#cb904-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb904-11"><a href="lavaan-lab-19-multilevel-sem.html#cb904-11" aria-hidden="true" tabindex="-1"></a>modelFinalfit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(modelFinal, <span class="at">data =</span> Data, </span>
<span id="cb904-12"><a href="lavaan-lab-19-multilevel-sem.html#cb904-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cluster =</span> <span class="st">&quot;clus&quot;</span>, </span>
<span id="cb904-13"><a href="lavaan-lab-19-multilevel-sem.html#cb904-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb904-14"><a href="lavaan-lab-19-multilevel-sem.html#cb904-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov variances are negative</code></pre>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="lavaan-lab-19-multilevel-sem.html#cb906-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">summary</span>(modelFinalfit, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-12 ended normally after 48 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        30
##   Number of equality constraints                     3
## 
##   Number of observations                          1000
##   Number of clusters [clus]                        110
## 
## Model Test User Model:
##                                               Standard      Robust
##   Test Statistic                                 3.741       3.913
##   Degrees of freedom                                16          16
##   P-value (Chi-square)                           0.999       0.999
##   Scaling correction factor                                  0.956
##     Yuan-Bentler correction (Mplus variant)                       
## 
## Model Test Baseline Model:
## 
##   Test statistic                              3283.563    3481.228
##   Degrees of freedom                                24          24
##   P-value                                        0.000       0.000
##   Scaling correction factor                                  0.943
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000       1.000
##   Tucker-Lewis Index (TLI)                       1.006       1.005
##                                                                   
##   Robust Comparative Fit Index (CFI)                         1.000
##   Robust Tucker-Lewis Index (TLI)                            1.005
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -9527.367   -9527.367
##   Scaling correction factor                                  0.941
##       for the MLR correction                                      
##   Loglikelihood unrestricted model (H1)      -9525.497   -9525.497
##   Scaling correction factor                                  1.012
##       for the MLR correction                                      
##                                                                   
##   Akaike (AIC)                               19108.735   19108.735
##   Bayesian (BIC)                             19241.244   19241.244
##   Sample-size adjusted Bayesian (BIC)        19155.491   19155.491
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000       0.000
##   90 Percent confidence interval - lower         0.000       0.000
##   90 Percent confidence interval - upper         0.000       0.000
##   P-value RMSEA &lt;= 0.05                          1.000       1.000
##                                                                   
##   Robust RMSEA                                               0.000
##   90 Percent confidence interval - lower                     0.000
##   90 Percent confidence interval - upper                     0.000
## 
## Standardized Root Mean Square Residual (corr metric):
## 
##   SRMR (within covariance matrix)                0.004       0.004
##   SRMR (between covariance matrix)               0.014       0.014
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## 
## Level 1 [within]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw =~                                                                 
##     y1         (a)    1.000                               1.498    0.834
##     y2         (b)    0.992    0.031   31.996    0.000    1.485    0.837
##     y3         (c)    0.982    0.035   27.682    0.000    1.470    0.816
##     y4         (d)    1.005    0.029   34.760    0.000    1.505    0.833
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fw ~                                                                  
##     x1                0.980    0.047   20.863    0.000    0.654    0.649
##     x2                0.515    0.039   13.113    0.000    0.344    0.347
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   x1 ~~                                                                 
##     x2                0.032    0.033    0.972    0.331    0.032    0.032
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.000                               0.000    0.000
##    .y2                0.000                               0.000    0.000
##    .y3                0.000                               0.000    0.000
##    .y4                0.000                               0.000    0.000
##     x1                0.007    0.036    0.194    0.846    0.007    0.007
##     x2                0.014    0.038    0.372    0.710    0.014    0.014
##    .fw                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1                0.983    0.063   15.631    0.000    0.983    0.305
##    .y2                0.944    0.056   16.896    0.000    0.944    0.300
##    .y3                1.084    0.057   18.963    0.000    1.084    0.334
##    .y4                1.001    0.064   15.764    0.000    1.001    0.307
##    .fw                0.995    0.081   12.358    0.000    0.444    0.444
##     x1                0.985    0.042   23.406    0.000    0.985    1.000
##     x2                1.017    0.049   20.603    0.000    1.017    1.000
## 
## 
## Level 2 [clus]:
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb =~                                                                 
##     y1         (a)    1.000                               0.653    1.005
##     y2         (b)    0.992    0.031   31.996    0.000    0.647    0.996
##     y3         (c)    0.982    0.035   27.682    0.000    0.641    1.017
##     y4         (d)    1.005    0.029   34.760    0.000    0.656    0.982
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   fb ~                                                                  
##     w                 0.333    0.076    4.389    0.000    0.510    0.461
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.083    0.072   -1.141    0.254   -0.083   -0.127
##    .y2               -0.077    0.073   -1.064    0.287   -0.077   -0.119
##    .y3               -0.045    0.069   -0.654    0.513   -0.045   -0.072
##    .y4               -0.029    0.072   -0.400    0.689   -0.029   -0.043
##     w                 0.006    0.086    0.070    0.944    0.006    0.007
##    .fb                0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .y1               -0.004    0.016   -0.246    0.806   -0.004   -0.010
##    .y2                0.003    0.019    0.177    0.859    0.003    0.008
##    .y3               -0.013    0.020   -0.660    0.509   -0.013   -0.033
##    .y4                0.016    0.020    0.778    0.436    0.016    0.036
##    .fb                0.336    0.061    5.520    0.000    0.788    0.788
##     w                 0.815    0.107    7.638    0.000    0.815    1.000</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lavaan-lab-18-cfa-of-mtmm-matrix.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
